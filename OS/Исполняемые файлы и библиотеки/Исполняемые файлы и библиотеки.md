![[Pasted image 20251212173901.png]]

### –ß—Ç–æ —Ç–∞–∫–æ–µ –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (Executable File)?

–≠—Ç–æ —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥), –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é.

- **–ü—Ä–∏–º–µ—Ä—ã:**
    
    - –í Windows —ç—Ç–æ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.exe`.
    - –í Unix/Linux/macOS —ç—Ç–æ —á–∞—Å—Ç–æ —Ñ–∞–π–ª—ã –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –Ω–æ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Ñ–ª–∞–≥–æ–º "–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π".

![[Pasted image 20251212173917.png]]

–ù–∞ —Å–ª–∞–π–¥–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ Unix-–ø–æ–¥–æ–±–Ω—ã—Ö –û–° (Linux, macOS, Solaris –∏ –¥—Ä.) ‚Äî **ELF**. 

–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –∞ **—Å—Ç—Ä–æ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** (**ELF**), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –û–° **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É** (–∏—Å–ø–æ–ª—å–∑—É—è –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –°–µ–∫—Ü–∏–∏) –∏ **—Å–≤—è–∑–∞—Ç—å –µ—ë —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –≤–Ω–µ—à–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏** (–∏—Å–ø–æ–ª—å–∑—É—è –¢–∞–±–ª–∏—Ü—É —Å–∏–º–≤–æ–ª–æ–≤ –∏ –†–µ–ª–æ–∫–∞—Ü–∏—é).

#### A. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ (–°—Ö–µ–º–∞ —Å–ª–µ–≤–∞)

–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π, –∫–∞–∫ –≤–∏–¥–Ω–æ –Ω–∞ —Å—Ö–µ–º–µ:

1. **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):** –≠—Ç–æ "–ø–∞—Å–ø–æ—Ä—Ç" —Ñ–∞–π–ª–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å—é —Å–ª—É–∂–µ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –û–° –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    
    - **¬´–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ¬ª (Magic Number):** –ü–µ—Ä–≤—ã–µ –±–∞–π—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç —Ç–∏–ø —Ñ–∞–π–ª–∞ (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, —á—Ç–æ —ç—Ç–æ ELF).
    - **–†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞/–¥–∞–Ω–Ω—ã—Ö:** –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–º–µ—Ä–∞—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ–∫—Ü–∏–π.
    - **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Entry Point):** –ê–¥—Ä–µ—Å (–≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞), —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.(–∞–¥—Ä–µ—Å `main`)
    - **–§–ª–∞–≥–∏:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –û–° –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.
        
2. **–°–µ–∫—Ü–∏–∏ (Sections):** –≠—Ç–æ –æ–±–ª–∞—Å—Ç–∏, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–¥ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    

#### B. –ö–ª—é—á–µ–≤—ã–µ –°–µ–∫—Ü–∏–∏

–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏:

- **`.text` (–¢–µ–∫—Å—Ç/–ö–æ–¥):** –ó–¥–µ—Å—å —Ö—Ä–∞–Ω–∏—Ç—Å—è **–º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥** (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞), –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–∞—à—É –ø—Ä–æ–≥—Ä–∞–º–º—É. –≠—Ç–∞ —Å–µ–∫—Ü–∏—è –æ–±—ã—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è.
    
- **`.data` (–î–∞–Ω–Ω—ã–µ):** –ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** (—Ç–µ, –∫–æ—Ç–æ—Ä—ã–º –≤—ã —è–≤–Ω–æ –ø—Ä–∏—Å–≤–æ–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, `int x = 10;`).
    
- **`.bss` (Block Starting by Symbol):** –ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è **–ù–ï–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** (—Ç–µ, –∫–æ—Ç–æ—Ä—ã–º –≤—ã –Ω–µ –ø—Ä–∏—Å–≤–æ–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, `int y;`). –í —Ñ–∞–π–ª–µ `.bss` –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–∞, –Ω–æ –º–µ—Å—Ç–æ –ø–æ–¥ –Ω–µ–µ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –ø–∞–º—è—Ç—å.
   –°–µ–∫—Ü–∏—è **`.bss`** **—Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∏–∫–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö**. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ, –≤ –ó–∞–≥–æ–ª–æ–≤–∫–µ ELF-—Ñ–∞–π–ª–∞ –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å:

> "–í–Ω–∏–º–∞–Ω–∏–µ! –ö–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å 4 –±–∞–π—Ç–∞ –ø–æ–¥ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `y` –∏ 1000 –±–∞–π—Ç –ø–æ–¥ –º–∞—Å—Å–∏–≤ `z[]`, –∏ **–∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —ç—Ç–∏ –æ–±–ª–∞—Å—Ç–∏ –Ω—É–ª—è–º–∏**."
    
- **`.rodata` (Read-Only Data):** –ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è **–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã** –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏).


**–¢–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤** –∏ **–ë–∏—Ç—ã —Ä–µ–ª–æ–∫–∞—Ü–∏–∏** ‚Äî —ç—Ç–æ **—Å–ª—É–∂–µ–±–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ**, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ **–ª–∏–Ω–∫–µ—Ä—É** (–ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª) –∏ **–∑–∞–≥—Ä—É–∑—á–∏–∫—É** (—á–∞—Å—Ç–∏ –û–°, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–∞–π–ª).

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –æ –†–µ–ª–æ–∫–∞—Ü–∏–∏:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Å–∏—Ç —É –û–°: "–ú–Ω–µ –Ω—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `printf` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `libc`".

- **–¢–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤** –≥–æ–≤–æ—Ä–∏—Ç: "–í–æ—Ç, –∏—â–∏ —Å–∏–º–≤–æ–ª `printf`".
    
- **–ë–∏—Ç—ã —Ä–µ–ª–æ–∫–∞—Ü–∏–∏** –≥–æ–≤–æ—Ä—è—Ç: "–ê –≤–æ—Ç —Ç—É—Ç, –≤ —Å—Ç—Ä–æ–∫–µ –∫–æ–¥–∞ ‚Ññ150, —è –æ—Å—Ç–∞–≤–∏–ª **–ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ**, –∫—É–¥–∞ –Ω—É–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å **—Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å** —Ñ—É–Ω–∫—Ü–∏–∏ `printf`, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Ç—ã –µ–≥–æ –Ω–∞–π–¥–µ—à—å –≤ –ø–∞–º—è—Ç–∏".
    

–≠—Ç–æ –∏ –µ—Å—Ç—å **–†–µ–ª–æ–∫–∞—Ü–∏—è** ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö "–ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç" —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

```
[Relocation table]  ->  —Å–æ–æ–±—â–∞–µ—Ç –≥–¥–µ –Ω—É–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å
      ‚Üì
[Symbol table]      ->  —Å–æ–æ–±—â–∞–µ—Ç –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ —Å–∏–º–≤–æ–ª –Ω—É–∂–µ–Ω
      ‚Üì
[Dynamic linker]    ->  –∏—â–µ—Ç —ç—Ç–æ—Ç —Å–∏–º–≤–æ–ª –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∞–¥—Ä–µ—Å
```

#### C. –†–æ–ª—å –ë–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –†–µ–ª–æ–∫–∞—Ü–∏–∏

–í–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–µ–¥–∫–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∞–º–∞ –ø–æ —Å–µ–±–µ. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≤–Ω–µ—à–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏** –∏–∑ **–±–∏–±–ª–∏–æ—Ç–µ–∫** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —ç–∫—Ä–∞–Ω, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ç.–¥.).

- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:** –≠—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–º–∏ –º–æ–≥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–º.
    
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, –ø–æ –∫–∞–∫–æ–º—É –∞–¥—Ä–µ—Å—É –≤ –ø–∞–º—è—Ç–∏ –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ –≤–Ω–µ—à–Ω–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
    
- **–†–µ—à–µ–Ω–∏–µ:**
    
    - **–ë–∏—Ç—ã —Ä–µ–ª–æ–∫–∞—Ü–∏–∏ (Relocation bits):** –£–∫–∞–∑—ã–≤–∞—é—Ç –ª–∏–Ω–∫–µ—Ä—É (–ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª), –∫–∞–∫–∏–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ (`.text`) –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å (–ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å), –∫–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø–∞–º—è—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç **—Ä–µ–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–†–µ–ª–æ–∫–∞—Ü–∏—è**.
        
    - **–¢–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤ (Symbol Table):** –°–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–º–µ–Ω (—Å–∏–º–≤–æ–ª–æ–≤) –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞, –∞ —Ç–∞–∫–∂–µ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∞–º. –≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –Ω—É–∂–Ω–∞, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å–∞ –º–µ–∂–¥—É –≤–∞—à–∏–º –∫–æ–¥–æ–º –∏ –∫–æ–¥–æ–º –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö.
### –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –∑–Ω–∞—Ç—å:
- **–∞ –≥–¥–µ –≤–æ–æ–±—â–µ –∏—Å–∫–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é?**
- **–ø–æ –∫–∞–∫–æ–º—É –∞–¥—Ä–µ—Å—É –æ–Ω–∞ –±—É–¥–µ—Ç –ª–µ–∂–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏?**
### –¢–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤

–≠—Ç–æ –∫–∞–∫ _—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫_, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞–ø–∏—Å–∞–Ω–æ:

- –∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ
- –∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω—É–∂–Ω—ã –∏–∑–≤–Ω–µ
- –≥–¥–µ –ª–µ–∂–∞—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –∫–∞–∫–∏–µ –∞–¥—Ä–µ—Å–∞ —É —ç—Ç–∏—Ö –≤–µ—â–µ–π

–î–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π —Ç–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤ –≥–æ–≤–æ—Ä–∏—Ç –û–°:

> ¬´–ú–Ω–µ –Ω—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è _printf_. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–π–¥–∏ –µ—ë –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ libc.¬ª

–ê –∑–∞—Ç–µ–º **–ª–∏–Ω–∫–æ–≤—â–∏–∫** –∏–ª–∏ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫** (ld.so) –Ω–∞—Ö–æ–¥–∏—Ç —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, —É–∑–Ω–∞—ë—Ç –µ—ë —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π.


![[Pasted image 20251212205151.png]]

![[Pasted image 20251212173931.png]]

`exec()` ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç –Ø–¥—Ä—É. –ï—ë –∑–∞–¥–∞—á–∞: **–∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤—ã–ø–æ–ª–Ω—è–µ–º—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ –Ω–æ–≤—É—é**, –∑–∞–≥—Ä—É–∑–∏–≤ –µ—ë –∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ.

### 1. –í–∞—à –ö–æ–¥ (–°—É–º–º–∞ –ß–∏—Å–µ–ª)

–ö–æ–≥–¥–∞ –≤—ã –ø–∏—à–µ—Ç–µ –ø—Ä–æ—Å—Ç—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ C:

C

```
#include <stdio.h>
int main() {
    int a = 5;
    int b = 3;
    printf("–°—É–º–º–∞: %d\n", a + b);
    return 0;
}
```

–í—ã –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç–µ –µ–≥–æ –≤ ELF-—Ñ–∞–π–ª: `./sum_program`.

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Shell (–ö–æ–º–∞–Ω–¥–Ω–∞—è –û–±–æ–ª–æ—á–∫–∞)

–ö–æ–≥–¥–∞ –≤—ã –≤–≤–æ–¥–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

Bash

```
$ ./sum_program
```

–í—ã –Ω–µ –ø–∏—à–µ—Ç–µ `exec()` –∏–ª–∏ `fork()`. –ù–æ **—Å–∞–º—É —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥—Ä—É–≥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞** ‚Äî –∫–æ–º–∞–Ω–¥–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ (**Shell**, –Ω–∞–ø—Ä–∏–º–µ—Ä, `bash` –∏–ª–∏ `zsh`).

### 3. –°—Ö–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —Ä—É—à–∏—Ç—Å—è, –∞ —Ä–∞–±–æ—Ç–∞–µ—Ç "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º"

–í—Å—è —Å—Ö–µ–º–∞ —Å `fork()` –∏ `exec()` **–Ω–µ —Ä—É—à–∏—Ç—Å—è**, –∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–≤–Ω—É—Ç—Ä–∏ Shell** –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ª—é–±—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –≤–∫–ª—é—á–∞—è –≤–∞—à—É `./sum_program`.

| **–®–∞–≥**             | **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç Shell (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å)**            | **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –Ø–¥—Ä–µ**                                                                                                                       |
| ------------------- | ------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| **1. –ß—Ç–µ–Ω–∏–µ**       | Shell –≤–∏–¥–∏—Ç –∫–æ–º–∞–Ω–¥—É `./sum_program`.                   | ---                                                                                                                                             |
| **2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | Shell –≤—ã–∑—ã–≤–∞–µ—Ç **`fork()`**.                           | –Ø–¥—Ä–æ —Å–æ–∑–¥–∞–µ—Ç –¥–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–Ω–æ–π –∫–æ–ø–∏–µ–π Shell.                                                                            |
| **3. –ó–ê–ú–ï–ù–ê!**      | –î–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–∑—ã–≤–∞–µ—Ç **`exec("./sum_program")`**. | –Ø–¥—Ä–æ –±–µ—Ä–µ—Ç –≤–∞—à ELF-—Ñ–∞–π–ª `./sum_program`, **–æ—á–∏—â–∞–µ—Ç** –ø–∞–º—è—Ç—å –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç –∫–æ–¥–∞ Shell –∏ **–∑–∞–≥—Ä—É–∂–∞–µ—Ç** —Ç—É–¥–∞ –∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã. |
| **4. –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ**   | ---                                                    | –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–∞—à –∫–æ–¥ (–Ω–∞—Ö–æ–¥–∏—Ç —Å—É–º–º—É, –ø–µ—á–∞—Ç–∞–µ—Ç –µ—ë).                                                                              |
| **5. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**   | ---                                                    | –î–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, –∏ Shell (—Ä–æ–¥–∏—Ç–µ–ª—å) –≤–∏–¥–∏—Ç —ç—Ç–æ –∏ –≤—ã–≤–æ–¥–∏—Ç –≤–∞–º –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É.                                                |
### –ß—Ç–µ–Ω–∏–µ –∏ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –§–æ—Ä–º–∞—Ç–∞ –§–∞–π–ª–∞

–Ø–¥—Ä–æ, –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º, –¥–æ–ª–∂–Ω–æ –ø–æ–Ω—è—Ç—å, **—á—Ç–æ –∏–º–µ–Ω–Ω–æ** –æ–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å.

- **–Ø–¥—Ä–æ —á–∏—Ç–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–∞–π–ª–∞:** –û–Ω–æ —Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç–æ–≤ (–∑–∞–≥–æ–ª–æ–≤–æ–∫) –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.
    
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞:** –Ø–¥—Ä–æ –∏—â–µ—Ç **¬´–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ¬ª** (Magic Number) ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–π—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–∏–ø —Ñ–∞–π–ª–∞.
    
    - **–ï—Å–ª–∏ ELF:** –ú–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ **`0x7F 'E' 'L' 'F'`** (—ç—Ç–æ –∫–∞–∫ "–ø–æ–¥–ø–∏—Å—å" —Ñ–æ—Ä–º–∞—Ç–∞ ELF). –Ø–¥—Ä–æ –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–µ–¥ –Ω–∏–º —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª.
        
    - **–ï—Å–ª–∏ –°–∫—Ä–∏–ø—Ç:** –§–∞–π–ª –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å **`#!`** (–Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "—à–µ–±–∞–Ω–≥"). –Ø–¥—Ä–æ –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ –Ω–µ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥, –∞ —Å–∫—Ä–∏–ø—Ç, —Ç—Ä–µ–±—É—é—â–∏–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞.
### –û–±—Ä–∞–±–æ—Ç–∫–∞ ELF-—Ñ–∞–π–ª–∞ (–ü–∞—Ä—Å–∏–Ω–≥ –ó–∞–≥–æ–ª–æ–≤–∫–∞)

–ï—Å–ª–∏ —è–¥—Ä–æ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–æ, —á—Ç–æ —Ñ–∞–π–ª ‚Äî —ç—Ç–æ ELF, –æ–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç **–ø–∞—Ä—Å–∏—Ç—å (—Ä–∞–∑–±–∏—Ä–∞—Ç—å)** –ó–∞–≥–æ–ª–æ–≤–æ–∫, —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –∑–Ω–∞—Ç—å, –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É:

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:** –£–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ —Ñ–∞–π–ª –±—ã–ª —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `x86_64` –∏–ª–∏ `ARM`). –ù–µ–ª—å–∑—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è Mac –Ω–∞ –æ–±—ã—á–Ω–æ–º –ü–ö —Å Windows (–±–µ–∑ —ç–º—É–ª—è—Ü–∏–∏).
    
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞:**
    
    - **`exec` (Executable):** –≠—Ç–æ –æ–±—ã—á–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é.
        
    - **`shared object` (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, `.so`):** –≠—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∞ –Ω–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (—Ö–æ—Ç—è —è–¥—Ä–æ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏—Ö –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π).
        
- **–°–µ–∫—Ü–∏–∏:** –Ø–¥—Ä–æ —É–∑–Ω–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π (`.text`, `.data`, –∏ —Ç.–¥.), —á—Ç–æ–±—ã –∑–Ω–∞—Ç—å, –∫—É–¥–∞ –≤ –ø–∞–º—è—Ç–∏ –∏—Ö –∑–∞–≥—Ä—É–∂–∞—Ç—å.
    

###  –û–±—Ä–∞–±–æ—Ç–∫–∞ –°–∫—Ä–∏–ø—Ç–æ–≤ (–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä)
---
### 1. ELF-—Ñ–∞–π–ª (Executable and Linkable Format)

- **–ß—Ç–æ —ç—Ç–æ:** **–ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª**, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π **–º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥** (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø–æ–Ω–∏–º–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é).
    
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ö–æ–≥–¥–∞ —è–¥—Ä–æ –≤–∏–¥–∏—Ç –º–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ `0x7F 'E' 'L' 'F'`, –æ–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥ –≤ –ø–∞–º—è—Ç—å –∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–Ω–∞–ø—Ä—è–º—É—é**.
    
- **–ü—Ä–∏–º–µ—Ä:** –ü—Ä–æ–≥—Ä–∞–º–º–∞, —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–∑ –∫–æ–¥–∞ C/C++ (`gcc`), Go, –∏–ª–∏ Rust.
    

### üîπ 2. –°–∫—Ä–∏–ø—Ç (Script)

- **–ß—Ç–æ —ç—Ç–æ:** **–ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª**, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞ **—è–∑—ã–∫–µ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è** (Bash, Python, Perl, PHP).
    
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é**, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –Ω–µ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥. –û–Ω —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å—Ç—Ä–æ—á–Ω–æ.
    
- **–ü—Ä–∏–º–µ—Ä:** –§–∞–π–ª `my_script.sh` –∏–ª–∏ `program.py`.
    

### üîπ 3. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä (Interpreter)

- **–ß—Ç–æ —ç—Ç–æ:** –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è **ELF-–ø—Ä–æ–≥—Ä–∞–º–º–∞** (–¥–∞, —Å–∞–º –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä ‚Äî —ç—Ç–æ ELF-—Ñ–∞–π–ª!), –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç **—á–∏—Ç–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã** –∏–∑ –°–∫—Ä–∏–ø—Ç–∞.
    
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/bin/bash` –∏–ª–∏ `/usr/bin/python`) **–ø–µ—Ä–µ–≤–æ–¥–∏—Ç** –∫–æ–º–∞–Ω–¥—ã —Å–∫—Ä–∏–ø—Ç–∞ –≤ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥ **–≤–æ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è** –∏ —Å—Ä–∞–∑—É –∂–µ –∏—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç.
#### –°—Ö–µ–º–∞ –∑–∞–ø—É—Å–∫–∞ –°–∫—Ä–∏–ø—Ç–∞ (–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª–∞–π–¥–∞)

–ö–æ–≥–¥–∞ —è–¥—Ä–æ –≤–∏–¥–∏—Ç —Ñ–∞–π–ª, –Ω–∞—á–∏–Ω–∞—é—â–∏–π—Å—è —Å **`#!` (—à–µ–±–∞–Ω–≥)**, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç "–ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è":

1. –í—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ: `$./my_script.sh`
    
2. –Ø–¥—Ä–æ –≤–∏–¥–∏—Ç: `#!/bin/bash`
    
3. –Ø–¥—Ä–æ **–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç** —Å–∫—Ä–∏–ø—Ç.
    
4. –Ø–¥—Ä–æ –≤—ã–∑—ã–≤–∞–µ—Ç `exec()` –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã `/bin/bash` (—ç—Ç–æ ELF-—Ñ–∞–π–ª!) –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –µ–π `my_script.sh` –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç.
    
5. –ü—Ä–æ–≥—Ä–∞–º–º–∞ `/bin/bash` (–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä) –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç **—á–∏—Ç–∞—Ç—å, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å** –∫–æ–º–∞–Ω–¥—ã –∏–∑ `my_script.sh`.
### 5. –û—à–∏–±–∫–∏

–ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–∏ –æ–¥–Ω–∏–º –∏–∑ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (–Ω–∏ ELF, –Ω–∏ —Å–∫—Ä–∏–ø—Ç, –Ω–∏ —Å—Ç–∞—Ä—ã–π `a.out`), —è–¥—Ä–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- **`ENOEXEC` (Exec format error):** –Ø–¥—Ä–æ –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç.
    
- **`EACCES` (Permission denied):** –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞.

```
process calls exec()
    ‚Üì
kernel reads first bytes of file
    ‚Üì
is it ELF?
    ‚Üì       ‚Üì
  yes       no
  ‚Üì         ‚Üì
parse ELF   script?
  ‚Üì         ‚Üì
load code   run interpreter
setup stack 
transfer control to entry point
```
–ü—Ä–∏–º–µ—Ä:
```
kriasatri@kriasa2006:/mnt/f/2_kurs/1_sem/os/lab_4/src$ file program2
program2: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=01aa68595af64a69daf8f97e8f7ecc196ecae101, for GNU/Linux 3.2.0, not stripped
```
–≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç:

- **ELF** ‚Üí —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω–∞—è –∏—Å–ø–æ–ª–Ω—è–µ–º–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
- **x86-64** ‚Üí –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **dynamically linked** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (libc)
- **interpreter ‚Ä¶** ‚Üí –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ª–∏–Ω–∫–æ–≤—â–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∑–∏—Ç libc

–ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ç—å:

### –ó–∞–≥–æ–ª–æ–≤–æ–∫ ELF:

`readelf -h hello`
```
kriasatri@kriasa2006:/mnt/f/2_kurs/1_sem/os/lab_4/src$ readelf -h program1
ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF64
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              DYN (Position-Independent Executable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x11a0
  Start of program headers:          64 (bytes into file)
  Start of section headers:          14456 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           56 (bytes)
  Number of program headers:         13
  Size of section headers:           64 (bytes)
  Number of section headers:         31
  Section header string table index: 30
```
### –°–µ–∫—Ü–∏–∏:

`readelf -S hello`
```
kriasatri@kriasa2006:/mnt/f/2_kurs/1_sem/os/lab_4/src$ readelf -S program1
There are 31 section headers, starting at offset 0x3878:

Section Headers:
  [Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  [ 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  [ 1] .interp           PROGBITS         0000000000000318  00000318
       000000000000001c  0000000000000000   A       0     0     1
  [ 2] .note.gnu.pr[...] NOTE             0000000000000338  00000338
       0000000000000030  0000000000000000   A       0     0     8
  [ 3] .note.gnu.bu[...] NOTE             0000000000000368  00000368
       0000000000000024  0000000000000000   A       0     0     4
  [ 4] .note.ABI-tag     NOTE             000000000000038c  0000038c
       0000000000000020  0000000000000000   A       0     0     4
  [ 5] .gnu.hash         GNU_HASH         00000000000003b0  000003b0
       0000000000000024  0000000000000000   A       6     0     8
  [ 6] .dynsym           DYNSYM           00000000000003d8  000003d8
       0000000000000198  0000000000000018   A       7     1     8
  [ 7] .dynstr           STRTAB           0000000000000570  00000570
       00000000000000f3  0000000000000000   A       0     0     1
  [ 8] .gnu.version      VERSYM           0000000000000664  00000664
       0000000000000022  0000000000000002   A       6     0     2
  [ 9] .gnu.version_r    VERNEED          0000000000000688  00000688
       0000000000000040  0000000000000000   A       7     1     8
  [10] .rela.dyn         RELA             00000000000006c8  000006c8
       00000000000000c0  0000000000000018   A       6     0     8
  [11] .rela.plt         RELA             0000000000000788  00000788
       0000000000000108  0000000000000018  AI       6    24     8
  [12] .init             PROGBITS         0000000000001000  00001000
       000000000000001b  0000000000000000  AX       0     0     4
  [13] .plt              PROGBITS         0000000000001020  00001020
       00000000000000c0  0000000000000010  AX       0     0     16
  [14] .plt.got          PROGBITS         00000000000010e0  000010e0
       0000000000000010  0000000000000010  AX       0     0     16
  [15] .plt.sec          PROGBITS         00000000000010f0  000010f0
       00000000000000b0  0000000000000010  AX       0     0     16
  [16] .text             PROGBITS         00000000000011a0  000011a0
       000000000000077c  0000000000000000  AX       0     0     16
  [17] .fini             PROGBITS         000000000000191c  0000191c
       000000000000000d  0000000000000000  AX       0     0     4
  [18] .rodata           PROGBITS         0000000000002000  00002000
       0000000000000238  0000000000000000   A       0     0     8
  [19] .eh_frame_hdr     PROGBITS         0000000000002238  00002238
       0000000000000044  0000000000000000   A       0     0     4
  [20] .eh_frame         PROGBITS         0000000000002280  00002280
       00000000000000ec  0000000000000000   A       0     0     8
  [21] .init_array       INIT_ARRAY       0000000000003d48  00002d48
       0000000000000008  0000000000000008  WA       0     0     8
  [22] .fini_array       FINI_ARRAY       0000000000003d50  00002d50
       0000000000000008  0000000000000008  WA       0     0     8
  [23] .dynamic          DYNAMIC          0000000000003d58  00002d58
       0000000000000210  0000000000000010  WA       7     0     8
  [24] .got              PROGBITS         0000000000003f68  00002f68
       0000000000000098  0000000000000008  WA       0     0     8
  [25] .data             PROGBITS         0000000000004000  00003000
       0000000000000010  0000000000000000  WA       0     0     8
  [26] .bss              NOBITS           0000000000004010  00003010
       0000000000000008  0000000000000000  WA       0     0     1
  [27] .comment          PROGBITS         0000000000000000  00003010
       000000000000002b  0000000000000001  MS       0     0     1
  [28] .symtab           SYMTAB           0000000000000000  00003040
       0000000000000480  0000000000000018          29    20     8
  [29] .strtab           STRTAB           0000000000000000  000034c0
       000000000000029e  0000000000000000           0     0     1
  [30] .shstrtab         STRTAB           0000000000000000  0000375e
       000000000000011a  0000000000000000           0     0     1
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),
  L (link order), O (extra OS processing required), G (group), T (TLS),
  C (compressed), x (unknown), o (OS specific), E (exclude),
  D (mbind), l (large), p (processor specific)
```
### –°–∏–º–≤–æ–ª—ã:

`readelf -s hello`
```
kriasatri@kriasa2006:/mnt/f/2_kurs/1_sem/os/lab_4/src$ readelf -s program1

Symbol table '.dynsym' contains 17 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND _[...]@GLIBC_2.34 (2)
     2: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterT[...]
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND atof@GLIBC_2.2.5 (3)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND write@GLIBC_2.2.5 (3)
     5: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND sin_integral
     6: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND [...]@GLIBC_2.2.5 (3)
     7: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __[...]@GLIBC_2.4 (4)
     8: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND [...]@GLIBC_2.2.5 (3)
     9: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND [...]@GLIBC_2.2.5 (3)
    10: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND read@GLIBC_2.2.5 (3)
    11: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND [...]@GLIBC_2.2.5 (3)
    12: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    13: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND e
    14: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND atoi@GLIBC_2.2.5 (3)
    15: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMC[...]
    16: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND [...]@GLIBC_2.2.5 (3)

Symbol table '.symtab' contains 48 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS Scrt1.o
     2: 000000000000038c    32 OBJECT  LOCAL  DEFAULT    4 __abi_tag
     3: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
     4: 00000000000011d0     0 FUNC    LOCAL  DEFAULT   16 deregister_tm_clones
     5: 0000000000001200     0 FUNC    LOCAL  DEFAULT   16 register_tm_clones
     6: 0000000000001240     0 FUNC    LOCAL  DEFAULT   16 __do_global_dtors_aux
     7: 0000000000004010     1 OBJECT  LOCAL  DEFAULT   26 completed.0
     8: 0000000000003d50     0 OBJECT  LOCAL  DEFAULT   22 __do_global_dtor[...]
     9: 0000000000001280     0 FUNC    LOCAL  DEFAULT   16 frame_dummy
    10: 0000000000003d48     0 OBJECT  LOCAL  DEFAULT   21 __frame_dummy_in[...]
    11: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS program1.c
    12: 0000000000001289   584 FUNC    LOCAL  DEFAULT   16 command_1
    13: 00000000000014d1   354 FUNC    LOCAL  DEFAULT   16 command_2
    14: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    15: 0000000000002368     0 OBJECT  LOCAL  DEFAULT   20 __FRAME_END__
    16: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS 
    17: 0000000000003d58     0 OBJECT  LOCAL  DEFAULT   23 _DYNAMIC
    18: 0000000000002238     0 NOTYPE  LOCAL  DEFAULT   19 __GNU_EH_FRAME_HDR
    19: 0000000000003f68     0 OBJECT  LOCAL  DEFAULT   24 _GLOBAL_OFFSET_TABLE_
    20: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_mai[...]
    21: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterT[...]
    22: 0000000000004000     0 NOTYPE  WEAK   DEFAULT   25 data_start
    23: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND atof@GLIBC_2.2.5
    24: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND write@GLIBC_2.2.5
    25: 0000000000004010     0 NOTYPE  GLOBAL DEFAULT   25 _edata
    26: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND sin_integral
    27: 000000000000191c     0 FUNC    GLOBAL HIDDEN    17 _fini
    28: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND strlen@GLIBC_2.2.5
    29: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __stack_chk_fail[...]
    30: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND snprintf@GLIBC_2.2.5
    31: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND strtok_r@GLIBC_2.2.5
    32: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND read@GLIBC_2.2.5
    33: 0000000000004000     0 NOTYPE  GLOBAL DEFAULT   25 __data_start
    34: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND strcmp@GLIBC_2.2.5
    35: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    36: 0000000000004008     0 OBJECT  GLOBAL HIDDEN    25 __dso_handle
    37: 0000000000002000     4 OBJECT  GLOBAL DEFAULT   18 _IO_stdin_used
    38: 0000000000004018     0 NOTYPE  GLOBAL DEFAULT   26 _end
    39: 00000000000011a0    38 FUNC    GLOBAL DEFAULT   16 _start
    40: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND e
    41: 0000000000004010     0 NOTYPE  GLOBAL DEFAULT   26 __bss_start
    42: 0000000000001633   745 FUNC    GLOBAL DEFAULT   16 main
    43: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND atoi@GLIBC_2.2.5
    44: 0000000000004010     0 OBJECT  GLOBAL HIDDEN    25 __TMC_END__
    45: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMC[...]
    46: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@G[...]
    47: 0000000000001000     0 FUNC    GLOBAL HIDDEN    12 _init
```

### –†–µ–ª–æ–∫–∞—Ü–∏–∏:

`readelf -r hello`
```
kriasatri@kriasa2006:/mnt/f/2_kurs/1_sem/os/lab_4/src$ readelf -r program1

Relocation section '.rela.dyn' at offset 0x6c8 contains 8 entries:
  Offset          Info           Type           Sym. Value    Sym. Name + Addend
000000003d48  000000000008 R_X86_64_RELATIVE                    1280
000000003d50  000000000008 R_X86_64_RELATIVE                    1240
000000004008  000000000008 R_X86_64_RELATIVE                    4008
000000003fd8  000100000006 R_X86_64_GLOB_DAT 0000000000000000 __libc_start_main@GLIBC_2.34 + 0
000000003fe0  000200000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_deregisterTM[...] + 0
000000003fe8  000c00000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + 0
000000003ff0  000f00000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_registerTMCl[...] + 0
000000003ff8  001000000006 R_X86_64_GLOB_DAT 0000000000000000 __cxa_finalize@GLIBC_2.2.5 + 0

Relocation section '.rela.plt' at offset 0x788 contains 11 entries:
  Offset          Info           Type           Sym. Value    Sym. Name + Addend
000000003f80  000300000007 R_X86_64_JUMP_SLO 0000000000000000 atof@GLIBC_2.2.5 + 0
000000003f88  000400000007 R_X86_64_JUMP_SLO 0000000000000000 write@GLIBC_2.2.5 + 0
000000003f90  000500000007 R_X86_64_JUMP_SLO 0000000000000000 sin_integral + 0
000000003f98  000600000007 R_X86_64_JUMP_SLO 0000000000000000 strlen@GLIBC_2.2.5 + 0
000000003fa0  000700000007 R_X86_64_JUMP_SLO 0000000000000000 __stack_chk_fail@GLIBC_2.4 + 0
000000003fa8  000800000007 R_X86_64_JUMP_SLO 0000000000000000 snprintf@GLIBC_2.2.5 + 0
000000003fb0  000900000007 R_X86_64_JUMP_SLO 0000000000000000 strtok_r@GLIBC_2.2.5 + 0
000000003fb8  000a00000007 R_X86_64_JUMP_SLO 0000000000000000 read@GLIBC_2.2.5 + 0
000000003fc0  000b00000007 R_X86_64_JUMP_SLO 0000000000000000 strcmp@GLIBC_2.2.5 + 0
000000003fc8  000d00000007 R_X86_64_JUMP_SLO 0000000000000000 e + 0
000000003fd0  000e00000007 R_X86_64_JUMP_SLO 0000000000000000 atoi@GLIBC_2.2.5 + 0
```
### ‚úÖ 1) `readelf -h program1` ‚Äî **ELF Header**

–≠—Ç–æ ¬´–ø–∞—Å–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞¬ª.

–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ:

üîπ Magic: `7f 45 4c 46`

–ì–æ–≤–æ—Ä–∏—Ç: **—ç—Ç–æ ELF-—Ñ–∞–π–ª**.

 üîπ Class: **ELF64**

64-–±–∏—Ç–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞.

 üîπ Data: **little endian**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ä—è–¥–æ–∫ –±–∞–π—Ç–æ–≤ x86-64.

 üîπ Type: **DYN (Position-Independent Executable)**

–≠—Ç–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ PIE-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–∞–∫ –≤—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã GCC.

‚û°Ô∏è –ó–Ω–∞—á–∏—Ç, –∫–æ–¥ –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤ –ª—é–±–æ–µ –º–µ—Å—Ç–æ –ø–∞–º—è—Ç–∏ ‚Üí –ª—É—á—à–µ –∑–∞—â–∏—Ç–∞.

 üîπ Machine: **x86-64 (AMD64)**

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

 üîπ Entry point: **0x11a0**

–° —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–∞ —è–¥—Ä–æ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.  
–ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `_start`.

 üîπ Program headers: 13

–û–ø–∏—Å—ã–≤–∞—é—Ç —Å–µ–≥–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —è–¥—Ä–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤ –ø–∞–º—è—Ç—å.

 üîπ Section headers: 31

–°–µ–∫—Ü–∏–∏ ‚Äî .text, .data, .bss, .plt, .dynsym –∏ —Ç. –¥.

---

### ‚úÖ 2) `readelf -S program1` ‚Äî _—Ä–∞–∑–¥–µ–ª—ã ELF_ (sections)

–°–ø–∏—Å–æ–∫ —Å–µ–∫—Ü–∏–π. –ì–ª–∞–≤–Ω–æ–µ:

### üìå –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –∑–Ω–∞—Ç—å:

- `.interp` ‚Äî –ø—É—Ç—å –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—É ELF (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –∑–∞–≥—Ä—É–∑—á–∏–∫—É)  
    ‚Üí –æ–±—ã—á–Ω–æ `/lib64/ld-linux-x86-64.so.2`
    
- `.text` ‚Äî –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥ —Ç–≤–æ–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
    
- `.rodata` ‚Äî —Å—Ç—Ä–æ–∫–∏, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    
- `.data` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    
- `.bss` ‚Äî –Ω—É–ª–µ–≤—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–∑–∞–Ω–∏–º–∞—é—Ç –º–µ—Å—Ç–æ _–≤ –ø–∞–º—è—Ç–∏_, –Ω–µ –≤ —Ñ–∞–π–ª–µ)
    
- `.plt`, `.got` ‚Äî —Ç–∞–±–ª–∏—Ü—ã –≤—ã–∑–æ–≤–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
    
- `.dynsym`, `.dynstr` ‚Äî —Ç–∞–±–ª–∏—Ü—ã —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
    
- `.rela.*` ‚Äî —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–ª–æ–∫–∞—Ü–∏–∏
    
- `.symtab`, `.strtab` ‚Äî —Ç–∞–±–ª–∏—Ü—ã –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–≤–∫–ª—é—á–∞—è –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
    

---
### ‚ùó .interp –≤–∞–∂–µ–Ω

–¢—ã —É–≤–∏–¥–µ–ª:

`[1] .interp  ...  "/lib64/ld-linux-x86-64.so.2"`

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

üëâ –ö–æ–≥–¥–∞ —è–¥—Ä–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç ELF, –æ–Ω–æ _–Ω–µ_ –∑–∞–ø—É—Å–∫–∞–µ—Ç –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é.  
–û–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ª–∏–Ω–∫–µ—Ä**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–æ–º –∑–∞–≥—Ä—É–∂–∞–µ—Ç libc, ld, –∏ —Ç.–ø.

---

### ‚úÖ 3) `readelf -r program1` ‚Äî **—Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–ª–æ–∫–∞—Ü–∏–π**

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –≤–Ω–µ—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã –Ω—É–∂–Ω–æ "–ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å" –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏.

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

`R_X86_64_GLOB_DAT __libc_start_main R_X86_64_JUMP_SLOT write R_X86_64_JUMP_SLOT atof`

`write@GLIBC_2.2.5`

–¢–≤–æ—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `write()`, –Ω–æ –æ–Ω–∞ –Ω–µ –≤ ELF ‚Üí –ª–µ–∂–∏—Ç –≤ libc.so.6.  
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –µ—ë –∞–¥—Ä–µ—Å –≤ PLT/GOT.

---
### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ–ª–æ–∫–∞—Ü–∏–π:

- `R_X86_64_RELATIVE` ‚Äî –∞–¥—Ä–µ—Å–∞ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ (–æ–±—ã—á–Ω–æ –¥–ª—è .data, .bss)
- `R_X86_64_GLOB_DAT` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ libc
- `R_X86_64_JUMP_SLOT` ‚Äî –Ω—É–∂–Ω—ã –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ PLT
    

---

### ‚úÖ 4) `readelf -s program1` ‚Äî **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤**

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ **–≤–Ω–µ—à–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–≤–æ—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç**.  
–ù–∞–ø—Ä–∏–º–µ—Ä:

`write read snprintf atof atoi strcmp`

–¢–∞–∫–∂–µ –≤–∏–¥–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ **—Ç–≤–æ–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã**, –µ—Å–ª–∏ –æ–Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö:

`sin_integral e`

(–æ–Ω–∏ –æ–±—ä—è–≤–ª–µ–Ω—ã –∫–∞–∫ extern –≥–¥–µ-—Ç–æ –≤ —Ç–≤–æ—ë–º C-–∫–æ–¥–µ)

## (–ß–∞—Å—Ç—å 2: –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ø–∞–º—è—Ç—å)

![[Pasted image 20251212173944.png]]

–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ `exec()` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —è–¥—Ä–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–æ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –∫–∞–∫ ELF.

### 1. –û—á–∏—Å—Ç–∫–∞ –∏ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

> _–Ø–¥—Ä–æ –æ—á–∏—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç PID –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ_

- **–û—á–∏—Å—Ç–∫–∞ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞:** –ü–æ–º–Ω–∏—Ç–µ, –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏, —á—Ç–æ `exec()` –∑–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É? –Ø–¥—Ä–æ **—Å—Ç–∏—Ä–∞–µ—Ç** –≤–µ—Å—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.
    
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:** –ù–æ –æ–Ω–æ **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç** —Å–∞–º **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä-–ø—Ä–æ—Ü–µ—Å—Å**:
    
    - **PID (Process ID):** –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º.
    - **–ü—Ä–∞–≤–∞:** –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≥—Ä—É–ø–ø—ã –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏.
    - **–û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã:** –§–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (—Å–≤—è–∑–∏ —Å —Ñ–∞–π–ª–∞–º–∏, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏) –æ—Å—Ç–∞—é—Ç—Å—è.
        
### 2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –°–µ–∫—Ü–∏–π –≤ –í–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ü–∞–º—è—Ç—å (`mmap()`)

> _–ò—Å–ø–æ–ª—å–∑—É—è —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ mmap(), —è–¥—Ä–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ–∫—Ü–∏–π ELF-—Ñ–∞–π–ª–∞ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å..._

–≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç. –Ø–¥—Ä–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç –≤–µ—Å—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å. –û–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ **`mmap()` (memory map)**, –∫–æ—Ç–æ—Ä—ã–π **–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç** (—Å–≤—è–∑—ã–≤–∞–µ—Ç) —Å–µ–∫—Ü–∏–∏ —Ñ–∞–π–ª–∞ —Å –æ–±–ª–∞—Å—Ç—è–º–∏ –≤ **–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ü–∞–º—è—Ç–∏ (–í–ü)** –ø—Ä–æ—Ü–µ—Å—Å–∞.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

1. **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (Lazy Loading):** –°–µ–∫—Ü–∏—è —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –¥–∏—Å–∫–∞ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –Ω–µ–π.
2. **–≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏:** –ù–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å—Ä–∞–∑—É –≤–µ—Å—å —Ñ–∞–π–ª, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–ø—É—Å–∫.
    
#### üéØ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –°–µ–∫—Ü–∏–∏

–î–ª—è –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏ –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç—Å—è –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º (MMU):

|**–°–µ–∫—Ü–∏—è**|**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**|**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**|
|---|---|---|
|**`.text` (–ö–æ–¥)**|`PROT_READ` (–ß—Ç–µ–Ω–∏–µ) **–∏** `PROT_EXEC` (–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ)|–ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–æ–ª–∂–µ–Ω –∏—Ö **—á–∏—Ç–∞—Ç—å** –∏ **–≤—ã–ø–æ–ª–Ω—è—Ç—å**. –ó–∞–ø—Ä–µ—Ç –Ω–∞ –∑–∞–ø–∏—Å—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≤–∑–ª–æ–º.|
|**`.data`**|`PROT_READ` (–ß—Ç–µ–Ω–∏–µ) **–∏** `PROT_WRITE` (–ó–∞–ø–∏—Å—å)|–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –∏—Ö **—á–∏—Ç–∞—Ç—å** –∏ **–∏–∑–º–µ–Ω—è—Ç—å**.|
|**`.rodata`**|`PROT_READ` (–ß—Ç–µ–Ω–∏–µ)|–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –∏—Ö —Ç–æ–ª—å–∫–æ **—á–∏—Ç–∞—Ç—å** (–∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–ø–∏—Å–∏).|
|**`.bss`**|`PROT_READ` (–ß—Ç–µ–Ω–∏–µ) **–∏** `PROT_WRITE` (–ó–∞–ø–∏—Å—å)|**–ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞.** –Ø–¥—Ä–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–¥–µ–ª—è–µ—Ç –∫—É—Å–æ–∫ –ø–∞–º—è—Ç–∏ –∏ **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ –Ω—É–ª—è–º–∏** (–æ—Ç—Å—é–¥–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ "Block Starting by Symbol")|

### 3. –ó–∞—â–∏—Ç–∞ –∏ ASLR

> _–ê–¥—Ä–µ—Å–∞ –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è —Å —É—á—ë—Ç–æ–º ASLR (Address Space Layout Randomization) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏..._

- **ASLR (–†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞):** –î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–µ–∫—Ü–∏–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–¥ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏) –ø–æ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ, **–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º** –∞–¥—Ä–µ—Å–∞–º –∫–∞–∂–¥—ã–π —Ä–∞–∑. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–Ω–æ **—Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Å–¥–≤–∏–≥–∞–µ—Ç** –Ω–∞—á–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞.
    
- **–¶–µ–ª—å:** –≠—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –∞—Ç–∞–∫–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –∑–Ω–∞–Ω–∏–∏ —Ç–æ—á–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Return-Oriented Programming).
    
### 4. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ –∏ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

> _–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–∞, —è–¥—Ä–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ (linker) `/lib/ld-linux.so`._

–ï—Å–ª–∏ –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏** (–ø–æ—á—Ç–∏ –≤—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `libc.so`, `libm.so` –∏ —Ç.–¥.), –µ–π –Ω—É–∂–µ–Ω –ø–æ—Å—Ä–µ–¥–Ω–∏–∫, —á—Ç–æ–±—ã –∏—Ö –Ω–∞–π—Ç–∏ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å.

- **–Ø–¥—Ä–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫:** –Ø–¥—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç –≤ ELF-—Ñ–∞–π–ª–µ –∑–∞–ø–∏—Å—å –æ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –∑–∞–≥—Ä—É–∑—á–∏–∫–µ** (—ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π ELF-—Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, `/lib/ld-linux.so`). –Ø–¥—Ä–æ **–∑–∞–ø—É—Å–∫–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø–µ—Ä–≤—ã–º**, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.
    
- **–†–∞–±–æ—Ç–∞ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞:** –¢–µ–ø–µ—Ä—å **–∑–∞–≥—Ä—É–∑—á–∏–∫** (–∞ –Ω–µ —è–¥—Ä–æ!) –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
    
    1. –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (–Ω–∞–ø—Ä., `libc.so`).
    2. –ó–∞–≥—Ä—É–∑–∫—É —ç—Ç–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤ –ø–∞–º—è—Ç—å (—Ç–∞–∫–∂–µ —á–µ—Ä–µ–∑ `mmap()`).
    3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ **–†–µ–ª–æ–∫–∞—Ü–∏–∏** ‚Äî –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ "–ø—É—Å—Ç—ã—Ö –º–µ—Å—Ç" –≤ –≤–∞—à–µ–º –∫–æ–¥–µ **—Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏** –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
        
- **–ü–µ—Ä–µ–¥–∞—á–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –≤—Å–µ –∞–¥—Ä–µ—Å–∞ —Å–≤—è–∑–∞–Ω—ã, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫, –Ω–∞–∫–æ–Ω–µ—Ü, –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ **–¢–æ—á–∫—É –≤—Ö–æ–¥–∞** (main-—Ñ—É–Ω–∫—Ü–∏—é) –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    

---

**–ò—Ç–æ–≥:** 
1. **–ü—Ä–æ—Ü–µ—Å—Å-–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä:** –≠—Ç–æ **–æ–±–æ–ª–æ—á–∫–∞**, –∫–æ—Ç–æ—Ä—É—é –Ø–¥—Ä–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏ (PID, –ø—Ä–∞–≤–∞, –ø–∞–º—è—Ç—å). **–≠—Ç–∞ –æ–±–æ–ª–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è!**
    
2. **–°—Ç–∞—Ä–∞—è –ü—Ä–æ–≥—Ä–∞–º–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Shell):** –ï—ë **–∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ** –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞. **–≠—Ç–æ —Å—Ç–∏—Ä–∞–µ—Ç—Å—è!**
    
3. **–ù–æ–≤–∞—è –ü—Ä–æ–≥—Ä–∞–º–º–∞ (`./sum_program`):** –ï—ë **–∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ** –∏–∑ —Ñ–∞–π–ª–∞ ELF –Ω–∞ –¥–∏—Å–∫–µ. **–≠—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è!**
    

- **–ß—Ç–æ —Å—Ç–∏—Ä–∞–µ—Ç—Å—è?** –°—Ç–∏—Ä–∞–µ—Ç—Å—è **—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–º—è—Ç–∏** —Å—Ç–∞—Ä–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ê–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ "–æ—á–∏—â–∞–µ—Ç—Å—è".
    
- **–ß—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è?** –û—Å—Ç–∞—ë—Ç—Å—è **—Å–∞–º –ø—Ä–æ—Ü–µ—Å—Å** —Å –µ–≥–æ PID –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.
    
- **–û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–¥?** –Ø–¥—Ä–æ –±–µ—Ä—ë—Ç –µ–≥–æ **–ò–ó –§–ê–ô–õ–ê ELF** (`./sum_program`), –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –Ω–∞ –¥–∏—Å–∫–µ.

### üí° –†–æ–ª—å Shell –≤ –ó–∞–ø—É—Å–∫–µ –ü—Ä–æ–≥—Ä–∞–º–º—ã

–î–∞–≤–∞–π—Ç–µ –µ—â—ë —Ä–∞–∑ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –≤–∞—à –ø—Ä–∏–º–µ—Ä:

1. **Shell –ó–∞–ø—É—â–µ–Ω:** –ö–æ–≥–¥–∞ –≤—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ `bash`. –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.
    
2. **–í—ã –≤–≤–æ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:** –í—ã –ø–µ—á–∞—Ç–∞–µ—Ç–µ: `$ ./sum_program` –∏ –Ω–∞–∂–∏–º–∞–µ—Ç–µ Enter.
    
3. **Shell –≤—ã–∑—ã–≤–∞–µ—Ç `fork()`:** Shell —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–µ–≥–æ –∫–ª–æ–Ω–∞ (–¥–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å). **Shell (—Ä–æ–¥–∏—Ç–µ–ª—å)** –∂–¥—ë—Ç.
    
4. **–ö–ª–æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç `exec()`:** –î–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å (–∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –∫–æ–ø–∏–µ–π Shell) –≤—ã–∑—ã–≤–∞–µ—Ç `exec("./sum_program")`.
    
5. **Shell –ó–∞–º–µ–Ω—ë–Ω:** –Ø–¥—Ä–æ —Å—Ç–∏—Ä–∞–µ—Ç –∫–æ–¥ Shell –∏–∑ –ø–∞–º—è—Ç–∏ –∫–ª–æ–Ω–∞ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∞—à –∫–æ–¥ `./sum_program`.
    

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, Shell ‚Äî —ç—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞, –∫–æ—Ç–æ—Ä–∞—è **–±—ã–ª–∞** –≤ –ø–∞–º—è—Ç–∏ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–æ–∫–∞ –Ω–µ –±—ã–ª–∞ **–∑–∞–º–µ–Ω–µ–Ω–∞** –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π.

Shell —è–≤–ª—è–µ—Ç—Å—è **–†–æ–¥–∏—Ç–µ–ª–µ–º** –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≥—Ä–∞–º–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ.

| **–ü—Ä–æ–≥—Ä–∞–º–º–∞**          | **–¢–∏–ø —Ñ–∞–π–ª–∞** | **–†–æ–ª—å**                    |
| ---------------------- | ------------- | --------------------------- |
| **`bash` (Shell)**     | ELF-—Ñ–∞–π–ª      | –ó–∞–ø—É—Å–∫–∞–µ—Ç –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. |
| **`./sum_program`**    | ELF-—Ñ–∞–π–ª      | –í—ã–ø–æ–ª–Ω—è–µ—Ç –≤–∞—à—É –∑–∞–¥–∞—á—É.      |
| **`/lib/ld-linux.so`** | ELF-—Ñ–∞–π–ª      | –ó–∞–≥—Ä—É–∂–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.       |
```
–í—ã—Å–æ–∫–∏–µ –∞–¥—Ä–µ—Å–∞ (0xFFFFFFFFFFFFFFFF)
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |     –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å —è–¥—Ä–∞ (kernel)      |
‚îÇ   |     - –¢–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü                      |
‚îÇ   |     - –Ø–¥—Ä–æ Linux                           |
‚îÇ   |     - –î—Ä–∞–π–≤–µ—Ä—ã                             |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |         VDSO / VVAR (—Å–ª—É–∂–µ–±–Ω—ã–µ ELF)       |
‚îÇ   |  - —É—Å–∫–æ—Ä–µ–Ω–∏–µ syscalls                      |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |         –°—Ç–µ–∫ (Stack)                       |
‚îÇ   |  - –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π                          |
‚îÇ   |  - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ                   |
‚îÇ   |  - —Ä–∞—Å—Ç—ë—Ç –≤–Ω–∏–∑ ‚Üò                           |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |         mmap-–æ–±–ª–∞—Å—Ç—å                       |
‚îÇ   |  - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (libc.so)       |
‚îÇ   |  - –æ–±–ª–∞—Å—Ç—å, –≤—ã–¥–µ–ª—è–µ–º–∞—è —á–µ—Ä–µ–∑ mmap()        |
‚îÇ   |  - —Ä–∞—Å—Ç—ë—Ç –≤–≤–µ—Ä—Ö ‚Üó                          |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |         Heap (–ö—É—á–∞)                        |
‚îÇ   |  - malloc/new                              |
‚îÇ   |  - —Ä–∞—Å—Ç—ë—Ç –≤–≤–µ—Ä—Ö ‚Üó                          |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |   .bss                                     |
‚îÇ   |   - –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä. –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ   |
‚îÇ   |   - –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω—É–ª—è–º–∏                       |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |   .data                                    |
‚îÇ   |   - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–º–µ–Ω. |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |   .rodata                                  |
‚îÇ   |   - —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ª–∏—Ç–µ—Ä–∞–ª—ã                     |
‚îÇ   |   - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã                              |
‚îÇ   +-------------------------------------------+
‚îÇ
‚îÇ   +-------------------------------------------+
‚îÇ   |   .text                                    |
‚îÇ   |   - –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã                 |
‚îÇ   |   - –ø—Ä–∞–≤–∞ r-x                              |
‚îÇ   +-------------------------------------------+
‚îÇ
–ù–∏–∑–∫–∏–µ –∞–¥—Ä–µ—Å–∞ (0x0000000000400000)  ‚Üê –æ–±—ã—á–Ω—ã–π ELF
```
## (–ß–∞—Å—Ç—å 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é) 

![[Pasted image 20251212174001.png]]

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∫–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ (—Å–µ–∫—Ü–∏–∏ `.text`, `.data`, `.rodata`, `.bss`) –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å, –Ø–¥—Ä–æ –¥–æ–ª–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ** –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω—É–∂–Ω—É—é –¥–ª—è —Ä–∞–±–æ—Ç—ã.

### 1. –í—ã–¥–µ–ª–µ–Ω–∏–µ –°—Ç–µ–∫–∞ (Stack)

> _–Ø–¥—Ä–æ –≤—ã–¥–µ–ª—è–µ—Ç —Å—Ç–µ–∫ (stack) –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (0x7ffffffff000 –Ω–∞ x86-64)_

- **–°—Ç–µ–∫** ‚Äî —ç—Ç–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è **–≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π** –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è **–ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**.
    
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ 64-–±–∏—Ç–Ω—ã—Ö) –°—Ç–µ–∫ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –≤ **–≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏** –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞.
    
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –Ø–¥—Ä–æ –≤—ã–¥–µ–ª—è–µ—Ç —ç—Ç—É –ø–∞–º—è—Ç—å –∏ —Ä–∞–∑–º–µ—â–∞–µ—Ç —Ç–∞–º —Å—Ç–∞—Ä—Ç–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–µ.
    
### 2. –ß—Ç–æ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ –°—Ç–µ–∫?

–Ø–¥—Ä–æ –¥–æ–ª–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–æ–≤–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∫–∞–∫–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –±—ã–ª–∏ –µ–π –¥–∞–Ω—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, –∏ –≤ –∫–∞–∫–æ–π —Å—Ä–µ–¥–µ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ –≤–µ—Ä—à–∏–Ω—É –°—Ç–µ–∫–∞:

- **–ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (`argv`):** –≠—Ç–æ –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–º–∞–Ω–¥—É –∏ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–≤–µ–ª–∏.
    
    - –ü—Ä–∏–º–µ—Ä: –ï—Å–ª–∏ –≤—ã –≤–≤–µ–ª–∏ `$./program —Ñ–∞–π–ª.txt`, –Ω–∞ —Å—Ç–µ–∫–µ –±—É–¥–µ—Ç `./program` –∏ `—Ñ–∞–π–ª.txt`.
        
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`envp`):** –≠—Ç–æ –Ω–∞–±–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö "–ò–º—è=–ó–Ω–∞—á–µ–Ω–∏–µ", –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Ä–∞–±–æ—á—É—é —Å—Ä–µ–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ñ–∞–π–ª–∞–º `PATH`, –¥–æ–º–∞—à–Ω—è—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `HOME`, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —è–∑—ã–∫–∞).
    
- **Auxiliary vector (`auxv`):** –≠—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –Ø–¥—Ä–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –∑–∞–≥—Ä—É–∑—á–∏–∫—É.
    
    - –ü—Ä–∏–º–µ—Ä—ã: –ê–¥—Ä–µ—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ, —Å–ª—É—á–∞–π–Ω—ã–µ –±–∞–π—Ç—ã (–¥–ª—è ASLR).
        

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –†–µ–≥–∏—Å—Ç—Ä–æ–≤

> _–£–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ argv –∏ envp —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö (rdi, rsi –Ω–∞ x86-64)_

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –°—Ç–µ–∫, –Ø–¥—Ä–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ **—Ä–µ–≥–∏—Å—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞** (`rdi`, `rsi` –∏ –¥—Ä.).

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–≥–∏—Å—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è **–±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–¥–∞—á–∏** –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –Ø–¥—Ä–æ —Å–æ–æ–±—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É: "–ù–∞—á–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥, –∞ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (`argv`) –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ `rdi`!"
    
- **–°–≤—è–∑—å —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `main()`:** –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –≤ C-–ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —Ñ—É–Ω–∫—Ü–∏—è `main` –æ–±—ã—á–Ω–æ –∏–º–µ–µ—Ç –≤–∏–¥ `int main(int argc, char *argv[])` ‚Äî —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ—Å—Ç—É–ø–∞—é—Ç –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –∏ —Å—Ç–µ–∫–∞, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —è–¥—Ä–æ–º.
    

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VDSO (Virtual Dynamic Shared Object)

> _–ï—Å–ª–∏ –µ—Å—Ç—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è VDSO (Virtual Dynamic Shared Object) ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –æ—Ç —è–¥—Ä–∞ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö syscall'–æ–≤..._

- **VDSO:** –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è **—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–∞–º—è—Ç–∏**, –∫–æ—Ç–æ—Ä—É—é **–Ø–¥—Ä–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞**. –û–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –∫–æ–¥–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–∞–º–∏–º –Ø–¥—Ä–æ–º.
    
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—á–µ–Ω—å —á–∞—Å—Ç—ã—Ö, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–∑–Ω–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è `gettimeofday`).
    
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –û–±—ã—á–Ω–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ (`syscall`) —Ç—Ä–µ–±—É–µ—Ç **–¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–µ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è** –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ —Ä–µ–∂–∏–º –Ø–¥—Ä–∞ (kernel space). –ö–æ–¥ –≤ VDSO –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —ç—Ç–∏ –≤—ã–∑–æ–≤—ã **–±–µ–∑ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è**, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–º–∏.

```
–í—ã—Å–æ–∫–∏–µ –∞–¥—Ä–µ—Å–∞
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 0x7fffffffffff
|                       [STACK TOP]                            |
|--------------------------------------------------------------|
|                argv, envp, auxv, alignment padding           |
|                                                              |
|              ‚Üì —Å—Ç–µ–∫ —Ä–∞—Å—Ç—ë—Ç –≤–Ω–∏–∑ (–∫ –º–µ–Ω—å—à–∏–º –∞–¥—Ä–µ—Å–∞–º)          |
|--------------------------------------------------------------|
|                          STACK                               |
|               (–æ–±—ã—á–Ω–æ –æ–∫–æ–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ú–ë)                   |
|--------------------------------------------------------------|  <-- guard page
|                         GAP                                  |
|                                                              |
|--------------------------------------------------------------|
|                          VDSO                                |
|        Virtual Dynamic Shared Object (~1‚Äì3 pages)            |
|        –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤:                        |
|        gettimeofday(), clock_gettime(), getcpu()             |
|--------------------------------------------------------------|
|                      VSYSCALL (–∏–Ω–æ–≥–¥–∞)                       |
|             –°—Ç–∞—Ä—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è            |
|--------------------------------------------------------------|
|                        Shared libs                           |
|       ld-linux.so, libc.so, libm.so –∏ –¥—Ä.                    |
|       –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ª–∏–Ω–∫–µ—Ä–æ–º —á–µ—Ä–µ–∑ mmap()         |
|--------------------------------------------------------------|
|                      Heap (–∫—É—á–∞)                             |
|      ‚Üë —Ä–∞—Å—Ç–∏ –≤–≤–µ—Ä—Ö: brk(), malloc()                          |
|--------------------------------------------------------------|
|                        .bss                                  |
|                        .data                                 |
|                        .rodata                               |
|                        .text                                 |
|                 (–æ—Å–Ω–æ–≤–Ω–æ–π –±–∏–Ω–∞—Ä—å ELF)                        |
|--------------------------------------------------------------| 0x400000
|                        ELF headers                           |
|--------------------------------------------------------------| 0x3fffff?
|                         NULL page                            |
|                        (–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ)                        |
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 0x0
–ù–∏–∑–∫–∏–µ –∞–¥—Ä–µ—Å–∞
```

–ò—Ç–æ–≥ –ø—Ä–æ —Ä–µ–≥–∏—Å—Ç—Ä—ã –∏ —Å—Ç–µ–∫:
–ù–∞ **–≤–µ—Ä—Ö —Å—Ç–µ–∫–∞** –∫–ª–∞–¥—É—Ç—Å—è:

- `argc` ‚Äî —á–∏—Å–ª–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- `argv[]` ‚Äî –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
- `envp[]` ‚Äî –º–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `auxv[]` ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∞–¥—Ä–µ—Å –∑–∞–≥—Ä—É–∑—á–∏–∫–∞, —Å–ª—É—á–∞–π–Ω—ã–µ –±–∞–π—Ç—ã –¥–ª—è ASLR –∏ —Ç.–¥.)

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `_start` (–∏ –¥–∞–ª–µ–µ `main()`), —è–¥—Ä–æ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–µ–ª–∞—é—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ:

- `RDI = argc`
- `RSI = —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ argv`
    

–≠—Ç–æ **–ø–µ—Ä–≤—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ main()** —Å–æ–≥–ª–∞—Å–Ω–æ System V ABI x86‚Äë64.

> –†–µ–≥–∏—Å—Ç—Ä—ã –Ω—É–∂–Ω—ã –¥–ª—è **–±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞** –∫ –¥–∞–Ω–Ω—ã–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—É –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.

- –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ `_start ‚Üí main`.
    
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ:
    
    - –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä—ã
    - –û—Å—Ç–∞–ª—å–Ω–æ–µ ‚Üí —Å—Ç–µ–∫ –∏–ª–∏ –∫—É—á–∞
        
- –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è**, –ø–æ—Ç–æ–º—É —á—Ç–æ:
    
    - –Ω–æ–≤—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π
    - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
    - –∞–¥—Ä–µ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–∞–º—è—Ç–∏

## (–ß–∞—Å—Ç—å 4: –ü–µ—Ä–µ–¥–∞—á–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

![[Pasted image 20251212174014.png]]

### 1 Entry point (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)

- –í ELF‚Äë—Ñ–∞–π–ª–µ –µ—Å—Ç—å **–∑–∞–≥–æ–ª–æ–≤–æ–∫ ELF**, –ø–æ–ª–µ `e_entry` ‚Üí **–∞–¥—Ä–µ—Å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã**.
- –û–±—ã—á–Ω–æ —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `_start()` –∏–∑ **crt0.o** (C runtime startup file).
- `_start` ‚Äî **–ø–µ—Ä–≤—ã–π –∫–æ–¥**, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –µ—â—ë –¥–æ main().
    
–ü—Ä–∏–º–µ—Ä:

`_start:     ; –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–µ–∫, —Ä–µ–≥–∏—Å—Ç—Ä—ã     ; –≤—ã–∑—ã–≤–∞–µ—Ç __libc_start_main(main, argc, argv, ...)`

> –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å ELF —á–µ—Ä–µ–∑ `readelf -h program1`:

`Entry point address: 0x11a0` - –≠—Ç–æ –∏ –µ—Å—Ç—å `_start`.

**–ü–æ—á–µ–º—É –Ω–µ —Å—Ä–∞–∑—É `main`?** 
–í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è `main()` –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–∞ –ø–µ—Ä–≤–æ–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ–π –Ω—É–∂–Ω–∞ **–ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω—É–ª–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏). `_start` –∫–∞–∫ —Ä–∞–∑ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —ç—Ç–æ–π –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π.

### 2 –ü–µ—Ä–µ—Ö–æ–¥ –≤ –†–µ–∂–∏–º –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

> _–ü—Ä–æ—Ü–µ—Å—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ user mode_

- **–†–µ–∂–∏–º –Ø–¥—Ä–∞ (Kernel Mode):** –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (–∑–∞–≥—Ä—É–∑–∫–∞, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–∫–∞) –Ø–¥—Ä–æ –≤—ã–ø–æ–ª–Ω—è–ª–æ, —Ä–∞–±–æ—Ç–∞—è –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º **—Ä–µ–∂–∏–º–µ –Ø–¥—Ä–∞**.
    
- **–†–µ–∂–∏–º –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (User Mode):** –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—Å–µ –≥–æ—Ç–æ–≤–æ, –Ø–¥—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤ **—Ä–µ–∂–∏–º –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Äî —Ä–µ–∂–∏–º —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.
    
- **–ü–µ—Ä–µ–¥–∞—á–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –Ø–¥—Ä–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä-—Å—á—ë—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥ (Instruction Pointer) –Ω–∞ –∞–¥—Ä–µ—Å –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (`_start`) –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É –Ω–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

### 3. –≠—Å—Ç–∞—Ñ–µ—Ç–∞ –í—ã–∑–æ–≤–æ–≤ (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –°–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ü—Ä–æ–≥—Ä–∞–º–º—ã)

> _–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ `_start()`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç `__libc_start_main()`, –∞ –∑–∞—Ç–µ–º `main()` –ø—Ä–æ–≥—Ä–∞–º–º—ã_

–ï—Å–ª–∏ –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–∞** (—Ç–æ –µ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏):

1. **`_start`:** –ü–µ—Ä–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫—É–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ. –û–Ω–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–∑–æ–≤ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞ (–µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É).

|**–ù–∞—Å—Ç—Ä–æ–π–∫–∞**|**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**|
|---|---|
|**–í—ã–∑–æ–≤ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞**|–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–∞**, `_start` –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –¥–æ–ª–∂–µ–Ω —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫** (`ld-linux.so`) –∑–∞–≤–µ—Ä—à–∏–ª –≤—Å—é —Å–≤–æ—é —Ä–∞–±–æ—Ç—É (–†–µ–ª–æ–∫–∞—Ü–∏—é, –ø–æ–∏—Å–∫ –≤—Å–µ—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫).|
|**–û—á–∏—Å—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤**|–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤ –Ω—É–ª–∏, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞.|
|**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–æ–≤**|–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–ª–∞–≥–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —á–∏—Å–ª–∞–º–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π (FPU) –∏ –¥—Ä—É–≥–∏—Ö –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π.|
|**–ü–µ—Ä–µ—Ö–æ–¥**|–°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ: –≤—ã–∑–æ–≤ —Å–ª–µ–¥—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ü–µ–ø–æ—á–∫–µ ‚Äî `__libc_start_main()`.|
    
2. **`__libc_start_main`:** –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ C (`libc`). –û–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è:**
    
    - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç C-–±–∏–±–ª–∏–æ—Ç–µ–∫—É (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏, –±—É—Ñ–µ—Ä—ã –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞).
    - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
    - –í—ã–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–µ—Å–ª–∏ —ç—Ç–æ C++).
    - –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `__libc_start_main` (–∫–æ—Ç–æ—Ä–∞—è —Å–∞–º–∞ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é `libc`), –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Ñ–∏–Ω–∞–ª—å–Ω–∞—è, –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** —Å–∞–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ C.

- **–ß—Ç–æ –∑–¥–µ—Å—å –¥–µ–ª–∞–µ—Ç—Å—è?** –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ C –ø–æ—Å–ª–µ —Å–≤–æ–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–ª–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å **—Å–≤–æ–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö**. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–Ω–∞ –º–æ–∂–µ—Ç:
    
    - –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –µ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏).
        
    - –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é (–µ—Å–ª–∏ –ö—É—á–∞ —É–∂–µ –≤—ã–¥–µ–ª–µ–Ω–∞).
        
3. **`main()`:** –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—Å–µ–π —ç—Ç–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏, `__libc_start_main()` –Ω–∞–∫–æ–Ω–µ—Ü –≤—ã–∑—ã–≤–∞–µ—Ç –≤–∞—à—É –ª—é–±–∏–º—É—é —Ñ—É–Ω–∫—Ü–∏—é `main()`, –∏ –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å **–≤–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥**.

### 4. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ö–æ–º–ø–æ–Ω–æ–≤–∫–∞

> _–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–∞, –∑–∞–≥—Ä—É–∑—á–∏–∫ –Ω–µ –Ω—É–∂–µ–Ω ‚Äî —Å—Ä–∞–∑—É –≤ –∫–æ–¥_

- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞:** –í–µ—Å—å –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫, –≤–∫–ª—é—á–∞—è `libc`, **—É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω** –≤ –≤–∞—à –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π ELF-—Ñ–∞–π–ª.
    
- **–ü—Ä–æ—Ü–µ—Å—Å:**
    
    1. –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ (`ld-linux.so`), —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è.
        
    2. –Ø–¥—Ä–æ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `_start` –≤ –≤–∞—à–µ–º —Ñ–∞–π–ª–µ, –∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ `main()` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞, –∞ –Ω–µ –≤–æ –≤–Ω–µ—à–Ω–µ–º –∑–∞–≥—Ä—É–∑—á–∏–∫–µ.

![[Pasted image 20251212174031.png]]

## FAQ: Memory Mapping, –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ –∏ CoW

### 1. –≠–∫–æ–Ω–æ–º–∏—è –ü–∞–º—è—Ç–∏ (–†–∞–∑–¥–µ–ª—è–µ–º—ã–µ –°–µ–∫—Ü–∏–∏)

> Q: –ë—É–¥–µ—Ç –ª–∏ —è–¥—Ä–æ –∏ –∑–∞–≥—Ä—É–∑—á–∏–∫ –≤—ã–¥–µ–ª—è—Ç—å –Ω–æ–≤—É—é –ø–∞–º—è—Ç—å, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ–∫—Ü–∏–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫?
> 
> A: –ù–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ —è–¥—Ä–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç memory mapping, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–µ–∫—Ü–∏–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫. –¢–∞–∫ –º—ã —ç–∫–æ–Ω–æ–º–∏–º –ø–∞–º—è—Ç—å –∏ –ø–æ–ª—å–∑—É–µ–º—Å—è –æ–¥–Ω–æ–π –∏–∑ –≤–∞–∂–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

- **–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ 100 –ø—Ä–æ–≥—Ä–∞–º–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `libc.so`, –∏ –∫–∞–∂–¥–∞—è –∏–∑ –Ω–∏—Ö –∑–∞–≥—Ä—É–∑–∏—Ç —Å–≤–æ—é –∫–æ–ø–∏—é –∫–æ–¥–∞ `libc` –≤ –ø–∞–º—è—Ç—å, —ç—Ç–æ –±—É–¥–µ—Ç –ø—É—Å—Ç–∞—è —Ç—Ä–∞—Ç–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 –∫–æ–ø–∏–π –∫–æ–¥–∞ `printf`).
    
- **–†–µ—à–µ–Ω–∏–µ –Ø–¥—Ä–∞ (–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ü–∞–º—è—Ç—å):** –ö–æ–≥–¥–∞ —è–¥—Ä–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ `mmap()`, –æ–Ω–æ —Å–≤—è–∑—ã–≤–∞–µ—Ç **–æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏** (—Ç—É, –∫—É–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω –∫–æ–¥ `libc.so`) —Å **–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º** –∫–∞–∂–¥–æ–≥–æ –∏–∑ 100 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.
    
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ 100 –ø—Ä–æ–≥—Ä–∞–º–º **—Ä–∞–∑–¥–µ–ª—è—é—Ç –æ–¥–Ω—É –∫–æ–ø–∏—é –∫–æ–¥–∞** –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏. –≠–∫–æ–Ω–æ–º–∏—è –æ–≥—Ä–æ–º–Ω–∞!
    
### 2. –ü—Ä–∏–Ω—Ü–∏–ø CoW (Copy-on-Write)

> Q: –ö–∞–∫ –±—ã—Ç—å, –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ —Å–µ–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä data) —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –±—ã–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∞, –Ω–æ –æ–Ω–∞ –±—ã–ª–∞ –æ–±—â–µ–π –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≥—Ä–∞–º–º?
> 
> A: –Ø–¥—Ä–æ –ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–º CoW.

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

–ü—Ä–∏–Ω—Ü–∏–ø **CoW (Copy-on-Write ‚Äî –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —ç–∫–æ–Ω–æ–º–∏—Ç—å –ø–∞–º—è—Ç—å, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

- **–ü—Ä–æ–±–ª–µ–º–∞:**
    
    - –°–µ–∫—Ü–∏—è `.text` (–∫–æ–¥) –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—â–µ–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–¥ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.
        
    - –ê –∫–∞–∫ –±—ã—Ç—å —Å —Å–µ–∫—Ü–∏–µ–π `.data` (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ), –∫–æ—Ç–æ—Ä—É—é –∫–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å? –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –ê –∏–∑–º–µ–Ω–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ –æ–±—â–µ–π `.data`, –ø—Ä–æ—Ü–µ—Å—Å B –ø–æ–ª—É—á–∏—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.
        
- **–†–µ—à–µ–Ω–∏–µ CoW:**
    
    1. **–ù–∞—á–∞–ª–æ:** –°–Ω–∞—á–∞–ª–∞ —è–¥—Ä–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞–º—è—Ç–∏ `.data` –∫–∞–∫ **–æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö** –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–º –ø—Ä–∞–≤–æ **—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è** (Read-Only).
        
    2. **–ó–∞–ø–∏—Å—å:** –ö–æ–≥–¥–∞ **–ø—Ä–æ—Ü–µ—Å—Å A** –ø—ã—Ç–∞–µ—Ç—Å—è **–∑–∞–ø–∏—Å–∞—Ç—å** –¥–∞–Ω–Ω—ã–µ –≤ —ç—Ç—É –æ–±—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É `.data` (—Ç.–µ. –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é), –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É (fault).
        
    3. **–î–µ–π—Å—Ç–≤–∏–µ –Ø–¥—Ä–∞:** –Ø–¥—Ä–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É, **—Å–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—É—é (–ª–∏—á–Ω—É—é) –∫–æ–ø–∏—é** —ç—Ç–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞–º—è—Ç–∏ **—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ê**, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—É –ê –∑–∞–ø–∏—Å–∞—Ç—å –≤ –Ω–µ–µ –¥–∞–Ω–Ω—ã–µ.
        
    4. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ—Ü–µ—Å—Å –ê —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –∫–æ–ø–∏—é –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é, –æ–±—â—É—é –∫–æ–ø–∏—é.
        

**CoW –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç:**

- **–≠–∫–æ–Ω–æ–º–∏—é –ø–∞–º—è—Ç–∏:** –ü–∞–º—è—Ç—å –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ **–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ**.
    
- **–ò–∑–æ–ª—è—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:** –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –º–æ–≥—É—Ç –º–µ—à–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥—É, –∏–∑–º–µ–Ω—è—è –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ.

![[Pasted image 20251212174045.png]]

**–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º **–≤–µ—Å—å** –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –∫–æ–¥ (–≤–∫–ª—é—á–∞—è –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫) –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è **–Ω–∞–ø—Ä—è–º—É—é** –≤ –æ–¥–∏–Ω –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª **–¥–æ –∑–∞–ø—É—Å–∫–∞** –ø—Ä–æ–≥—Ä–∞–º–º—ã.

### 1. Compile time (–í—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏)

> _–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∫–æ–¥, –ø–æ–ª—É—á–∞—è –æ–±—ä–µ–∫—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–∏–º–≤–æ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤ –Ω–∏—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã, –∏ —Ç—Ä–µ–±—É—é—Ç —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤ –Ω–∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è_

- **–û–±—ä–µ–∫—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã (`.o`):** –í–∞—à –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `main.c`) –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ‚Äî –æ–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª.
    
- **–°–∏–º–≤–æ–ª—ã:** –û–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥, –Ω–æ –æ–Ω –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É. –í –Ω–µ–º –µ—Å—Ç—å:
    
    - **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã:** –§—É–Ω–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–æ–∑–¥–∞–ª–∏ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.
        –ü—Ä–∏–º–µ—Ä:
```
// file1.c
int sum(int a, int b) { return a+b; }
extern int multiply(int a, int b); // –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª

int main() {
    return multiply(2,3) + sum(2,3);
}
```
- `sum` ‚Üí –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª –≤ file1.o
- `multiply` ‚Üí –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª (–Ω–∞–¥–æ –Ω–∞–π—Ç–∏ –≤ –¥—Ä—É–≥–æ–º –æ–±—ä–µ–∫—Ç–Ω–æ–º —Ñ–∞–π–ª–µ)

    - **–¢—Ä–µ–±—É–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã:** –§—É–Ω–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `printf`) –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã **–∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ**, –Ω–æ –∫–æ—Ç–æ—Ä—ã–µ **–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã** –≥–¥–µ-—Ç–æ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `libc`).
        
```
call multiply ; —Ä–∞–Ω—å—à–µ –±—ã–ª –∑–∞–≥–ª—É—à–∫–æ–π
‚Üì –ø–∞—Ç—á–∏–Ω–≥ –∞–¥—Ä–µ—Å–∞
call 0x401000 ; –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ multiply
```
–†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –≥–æ—Ç–æ–≤—ã–π ELF, –≤ –∫–æ—Ç–æ—Ä–æ–º **–≤—Å–µ —Å–∏–º–≤–æ–ª—ã —É–∂–µ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã**
### 2. Link time (–í—Ä–µ–º—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ / –õ–∏–Ω–∫–æ–≤–∫–∏)

> _–≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ –æ–±—ä–µ–∫—Ç–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç (resolves) —Å–∏–º–≤–æ–ª—ã –≤ –∏—Ö –∞–¥—Ä–µ—Å–∞ –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —ç—Ç–∏ –∞–¥—Ä–µ—Å–∞ –≤ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥. –¢–æ –µ—Å—Ç—å –ø–∞—Ç—á–∏—Ç –∑–∞–≥–ª—É—à–∫–∏, –≥–¥–µ –Ω—É–∂–Ω—ã –∞–¥—Ä–µ—Å–∞_

–≠—Ç–æ **—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π** —ç—Ç–∞–ø –≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–µ:

- **–ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ (Linker):** –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–±–∏—Ä–∞–µ—Ç:
    
    1. –í–∞—à–∏ –æ–±—ä–µ–∫—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã (`.o`).
    2. –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞ –∏–∑ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (`.a`).
        
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ (Resolving):** –ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –≤—Å–µ "—Ç—Ä–µ–±—É–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã" (–Ω–∞–ø—Ä–∏–º–µ—Ä, `printf`) –∏ –Ω–∞—Ö–æ–¥–∏—Ç –∏—Ö **–∫–æ–¥** –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö.
    
- **–ü–∞—Ç—á–∏–Ω–≥ –∑–∞–≥–ª—É—à–µ–∫:** –ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ **–≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç** –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–¥ `printf` –ø—Ä—è–º–æ –≤ –≤–∞—à –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª. –¢–∞–º, –≥–¥–µ –≤ –≤–∞—à–µ–º –∫–æ–¥–µ –±—ã–ª–∞ "–∑–∞–≥–ª—É—à–∫–∞" –∏–ª–∏ "–º–µ—Ç–∫–∞" –¥–ª—è `printf`, –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ **–∑–∞–º–µ–Ω—è–µ—Ç** –µ–µ –Ω–∞ **—Ä–µ–∞–ª—å–Ω—ã–π, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å** (—Å–º–µ—â–µ–Ω–∏–µ) –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –Ω–æ–≤–æ–≥–æ, –±–æ–ª—å—à–æ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞.
    
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ–¥–∏–Ω, **–±–æ–ª—å—à–æ–π** ELF-—Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç **–≤—Å–µ** –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã, –∏ –µ–º—É –Ω–µ –Ω—É–∂–Ω—ã –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
---
    - –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —è–¥—Ä–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç ELF –≤ –ø–∞–º—è—Ç—å:
    
    - `.text` ‚Üí –∫–æ–¥
        
    - `.data` ‚Üí –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        
    - `.bss` ‚Üí –Ω—É–ª–∏
        
- –ü–æ—Å–∫–æ–ª—å–∫—É **–∞–¥—Ä–µ—Å–∞ —É–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã**, –ø—Ä–æ—Ü–µ—Å—Å **—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —Å–∏–º–≤–æ–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ —ç—Ç–∏–º –∞–¥—Ä–µ—Å–∞–º**
    
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –ª–∏–Ω–∫–µ—Ä–µ –∏–ª–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ ‚Äî –≤—Å—ë —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ
    

> –û—Ç–ª–∏—á–∏–µ –æ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏**: —Ç–∞–º —á–∞—Å—Ç—å –∞–¥—Ä–µ—Å–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —á–µ—Ä–µ–∑ –∑–∞–≥—Ä—É–∑—á–∏–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ PLT/GOT.
---
### 3. Runtime (–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è)

> _–æ–±—Ä–∞–∑ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –µ–≥–æ —Å–µ–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –≤ –ø–∞–º—è—Ç—å –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–¥—Ä–µ—Å–∞–º, –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–∞ —ç—Ç–æ –≤ —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç–µ_

- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞:** –ü–æ—Å–∫–æ–ª—å–∫—É –≤—Å–µ –∞–¥—Ä–µ—Å–∞ –≤ –∫–æ–¥–µ (—Å–≤—è–∑–∏ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏ –¥–∞–Ω–Ω—ã–º–∏) –±—ã–ª–∏ **–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã** –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–æ–º –Ω–∞ —ç—Ç–∞–ø–µ Link time, –ø—Ä–æ–≥—Ä–∞–º–º–∞ **–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞** –≤ –ø–∞–º—è—Ç—å –ø–æ —Ç–µ–º –∞–¥—Ä–µ—Å–∞–º, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∞ "—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç".
    
- **–ù–µ—Ç –ó–∞–≥—Ä—É–∑—á–∏–∫–∞/–†–µ–ª–æ–∫–∞—Ü–∏–∏:** –ò–∑-–∑–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤:
    
    - –ù–µ –Ω—É–∂–µ–Ω –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ (`ld-linux.so`).
        
    - –ù–µ –Ω—É–∂–Ω–∞ —Å–ª–æ–∂–Ω–∞—è **–†–µ–ª–æ–∫–∞—Ü–∏—è** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—Å–µ –∞–¥—Ä–µ—Å–∞ —É–∂–µ "–∑–∞–ø–∞—è–Ω—ã" –≤ –∫–æ–¥–µ.
        
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –ó–∞–ø—É—Å–∫–∞:** –Ø–¥—Ä–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π ELF-—Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å –ø–æ –Ω—É–∂–Ω—ã–º –∞–¥—Ä–µ—Å–∞–º, –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `_start`, –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
    
```
[Compile time]
   source.c ‚Üí gcc ‚Üí object.o
   | symbols: sum (defined), multiply (undefined)
   
[Link time]
   ld resolves multiply ‚Üí address 0x401000
   ELF ready ‚Üí –≤—Å–µ –∞–¥—Ä–µ—Å–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã

[Runtime]
   kernel loads ELF ‚Üí memory mapping
   .text, .data, .bss –∑–∞–≥—Ä—É–∂–µ–Ω—ã
   process executes code
   –∞–¥—Ä–µ—Å–∞ —Å–∏–º–≤–æ–ª–æ–≤ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã
```
---

### üí° –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ö–æ–º–ø–æ–Ω–æ–≤–∫–∏

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞**  | **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ö–æ–º–ø–æ–Ω–æ–≤–∫–∞**                           | **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ö–æ–º–ø–æ–Ω–æ–≤–∫–∞**                                |
| ------------------- | ---------------------------------------------------- | ---------------------------------------------------------- |
| **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞**    | **–û—á–µ–Ω—å –±–æ–ª—å—à–æ–π** (—Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Å—å –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫).     | **–ú–∞–ª–µ–Ω—å–∫–∏–π** (—Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –≤–∞—à –∫–æ–¥).                   |
| **–ê–¥—Ä–µ—Å–∞**          | **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** (–∑–∞–¥–∞–Ω—ã –ø—Ä–∏ –ª–∏–Ω–∫–æ–≤–∫–µ).             | **–°–º–µ—â–∞–µ–º—ã–µ** (–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ).                 |
| **–ó–∞–ø—É—Å–∫**          | **–û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π** (–Ω–µ –Ω—É–∂–Ω–∞ —Ä–µ–ª–æ–∫–∞—Ü–∏—è).              | **–ú–µ–¥–ª–µ–Ω–Ω–µ–µ** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫).          |
| **–≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏** | **–ü–ª–æ—Ö–∞—è** (–∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–º–µ–µ—Ç —Å–≤–æ—é –∫–æ–ø–∏—é `libc`). | **–û—Ç–ª–∏—á–Ω–∞—è** (–ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–∑–¥–µ–ª—è—é—Ç –æ–¥–Ω—É –∫–æ–ø–∏—é `libc` - CoW). |

![[Pasted image 20251212174057.png]]

**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫ –Ω–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, –∞ **–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è** —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π —É–∂–µ **–≤–æ –≤—Ä–µ–º—è –µ—ë –∑–∞–ø—É—Å–∫–∞** (Runtime).

### 1. Link time (–í—Ä–µ–º—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ / –õ–∏–Ω–∫–æ–≤–∫–∏)

> _–∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–º–∏, –Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ executable –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –µ–º—É —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã_

- **–ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ (Linker):** –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏, –∑–¥–µ—Å—å –æ–Ω –Ω–µ –∏—â–µ—Ç –∏ –Ω–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ `printf`.
    
- **–ù–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã:** –ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ –æ—Å—Ç–∞–≤–ª—è–µ—Ç **–∑–∞–≥–ª—É—à–∫–∏** (–∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö) –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –û–Ω –Ω–µ –∑–Ω–∞–µ—Ç –∏—Ö —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –≤ –ø–∞–º—è—Ç–∏.
    
- **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö:** –ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ ELF-—Ñ–∞–π–ª —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (`.interp` –∏ –¥—Ä—É–≥–∏–µ), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:
    
    1. –ü—É—Ç—å –∫ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –ó–∞–≥—Ä—É–∑—á–∏–∫—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/lib/ld-linux.so`).
        
    2. –°–ø–∏—Å–æ–∫ **–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `libc.so.6`, `libm.so.6`).
        

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –ø–æ–ª—É—á–∞–µ—Ç—Å—è **–≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω—å—à–µ**, –Ω–æ –æ–Ω **–Ω–µ—Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω** –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞.

### 2. Runtime (–í—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è)

> _–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –∏—Ö –∞–¥—Ä–µ—Å–∞, —Ä–∞–∑—ã—Å–∫–∏–≤–∞—è —Å–∏–º–≤–æ–ª—ã –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö_

–≠—Ç–æ—Ç —ç—Ç–∞–ø –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏:

1. **–Ø–¥—Ä–æ** –∑–∞–≥—Ä—É–∂–∞–µ—Ç **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫** (`ld-linux.so`) –≤ –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞.
    
2. **–ó–∞–≥—Ä—É–∑—á–∏–∫** —á–∏—Ç–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑ ELF-—Ñ–∞–π–ª–∞ –∏ –∏—â–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ –¥–∏—Å–∫–µ.
    
3. **–ó–∞–≥—Ä—É–∑—á–∏–∫** –∑–∞–≥—Ä—É–∂–∞–µ—Ç —ç—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏(`.so`) –≤ –í–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ü–∞–º—è—Ç—å (–∏—Å–ø–æ–ª—å–∑—É—è `mmap`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∏—Ç—å—Å—è –∫–æ–¥–æ–º –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏).
    
4. **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ (–†–µ–ª–æ–∫–∞—Ü–∏—è):** –ó–∞–≥—Ä—É–∑—á–∏–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–†–µ–ª–æ–∫–∞—Ü–∏—é** ‚Äî –æ–Ω –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –∑–∞–≥–ª—É—à–∫–∏ –≤ –≤–∞—à–µ–º –∫–æ–¥–µ –∏ **–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—É–¥–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** —Ñ—É–Ω–∫—Ü–∏–π `printf`, `malloc` –∏ –¥—Ä—É–≥–∏—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —Ç–æ–ª—å–∫–æ —á—Ç–æ –Ω–∞—à–µ–ª –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö.
    

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ —Å–≤—è–∑–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É, –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ `_start()`.

---

### –û—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏

|–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å|–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞|–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞|
|---|---|---|
|–ê–¥—Ä–µ—Å–∞ —Å–∏–º–≤–æ–ª–æ–≤|–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ª–∏–Ω–∫–æ–≤–∫–µ|–û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è|
|–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏|–í–∫–ª—é—á–µ–Ω—ã –≤ –±–∏–Ω–∞—Ä—å|–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (shared)|
|–†–∞–∑–º–µ—Ä ELF|–ë–æ–ª—å—à–µ (–≤—Å—ë –≤–∫–ª—é—á–µ–Ω–æ)|–ú–µ–Ω—å—à–µ (—Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏)|
|–ü–∞—Ç—á–∏–Ω–≥ —Å–∏–º–≤–æ–ª–æ–≤|–ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫|–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫|
|–ü—Ä–∏–º–µ—Ä|`gcc -static main.c`|`gcc main.c` (–æ–±—ã—á–Ω–æ)|
### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ `.c`, `.o`, `.so`

|–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ|–ß—Ç–æ —ç—Ç–æ|–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å?|–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è|
|---|---|---|---|
|`.c`|–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥|‚ùå|–ö–æ–º–ø–∏–ª—è—Ü–∏—è|
|`.o`|–û–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª|‚ùå|–õ–∏–Ω–∫–æ–≤–∫–∞|
|`.so`|–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞|‚ùå –Ω–∞–ø—Ä—è–º—É—é|Runtime, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞|

> –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª:

```
gcc main.o -o main            # —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è/—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–∏–Ω–∫–æ–≤–∫–∞
gcc main.c -o main            # –∫–æ–º–ø–∏–ª—è—Ü–∏—è + –ª–∏–Ω–∫–æ–≤–∫–∞ –∑–∞ –æ–¥–∏–Ω —à–∞–≥
gcc main.c -o main -ldl       # —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏
```
![[Pasted image 20251212174111.png]]

–Ø–¥—Ä–æ (–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –°–∏—Å—Ç–µ–º–∞) –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ **–±–∞–∑–æ–≤—ã–µ, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ** –∑–∞–¥–∞—á–∏:

- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ (`fork()`).
- –ß—Ç–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ ELF –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ **—Å–∞–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã** –≤ –ø–∞–º—è—Ç—å (`exec()` / `mmap()`).
- –ó–∞–ø—É—Å–∫ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞** (–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞).
    
–Ø–¥—Ä–æ –Ω–µ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä—É—Ç–∏–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π –ø–æ –ø–æ–∏—Å–∫—É, –∑–∞–≥—Ä—É–∑–∫–µ –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫ ‚Äî —ç—Ç–æ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ –∏ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –æ—à–∏–±–∫–∞–º.

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ (`ld.so`)

- –≠—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, –∫–æ—Ç–æ—Ä–∞—è **–∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã**.
    
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ ELF —è–¥—Ä–æ **–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä**, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ ELF (–ø–æ–ª–µ `.interp`).  
    –ü—Ä–∏–º–µ—Ä: `/lib64/ld-linux-x86-64.so.2`

- –≠—Ç–æ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫:
    
    1. –ß–∏—Ç–∞–µ—Ç —Å–µ–∫—Ü–∏—é `.dynamic` ELF-—Ñ–∞–π–ª–∞ ‚Üí —É–∑–Ω–∞—ë—Ç, –∫–∞–∫–∏–µ `.so` –Ω—É–∂–Ω—ã
    2. –ß–µ—Ä–µ–∑ `mmap()` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —ç—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ –ø–∞–º—è—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã
    3. –†–∞–∑—Ä–µ—à–∞–µ—Ç —Å–∏–º–≤–æ–ª—ã –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Ö –∞–¥—Ä–µ—Å–∞ –≤ PLT/GOT

 Memory mapping –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- –ó–∞–≥—Ä—É–∑—á–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **memory mapping (mmap)**, —á—Ç–æ–±—ã:
    
    - `.text` ‚Üí read & execute, –º–æ–∂–Ω–æ –¥–µ–ª–∏—Ç—å –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
    - `.data` ‚Üí CoW, –∫–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        
- –≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –ø–∞–º—è—Ç—å –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤**.
![[Pasted image 20251212174124.png]]

### –ü–æ—Ä—è–¥–æ–∫ –ó–∞–≥—Ä—É–∑–∫–∏ –∏ –ê–Ω–∞–ª–∏–∑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

> _–ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä... –≠—Ç–æ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫ (`ld.so`) –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã (–∏–∑ —Å–µ–∫—Ü–∏–∏ `.dynamic` ELF-—Ñ–∞–π–ª–∞)..._

1. **–ó–∞–ø—É—Å–∫ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞:** –Ø–¥—Ä–æ, –ø—Ä–æ—á–∏—Ç–∞–≤ –ø–æ–ª–µ `.interp` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∑–∞–ø—É—Å–∫–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é —Ç–∞–º –ø—Ä–æ–≥—Ä–∞–º–º—É (`ld-linux.so`) **–ø–µ—Ä–≤–æ–π**.
    
2. **–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:** –ó–∞–≥—Ä—É–∑—á–∏–∫ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Å–µ–∫—Ü–∏—é –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã ‚Äî **`.dynamic`**. –í —ç—Ç–æ–π —Å–µ–∫—Ü–∏–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã **–≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏** (`libc.so`, `libm.so` –∏ —Ç.–¥.).
    
3. **–ü–æ–∏—Å–∫:** –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–∏ –∏–º–µ–Ω–∞, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –Ω–∞ –¥–∏—Å–∫–µ.
    

###  –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ë–∏–±–ª–∏–æ—Ç–µ–∫

> _–î–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è memory mapping, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–µ–∫—Ü–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞_

- –ù–∞–π–¥—è —Ñ–∞–π–ª—ã, –∑–∞–≥—Ä—É–∑—á–∏–∫ —Å–∞–º –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ **`mmap()`** –¥–ª—è –∫–∞–∂–¥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
    
- –ö–æ–¥ –∏ –¥–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–∞ **CoW** –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏, –∫–∞–∫ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏).
    
- –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–≥—Ä—É–∑—á–∏–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–†–µ–ª–æ–∫–∞—Ü–∏—é** –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `_start`.


![[Pasted image 20251212174140.png]]

–≠—Ç–æ—Ç —Å–ª–∞–π–¥ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞–µ—Ç **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ (`ld.so`)** –¥–ª—è –∫–∞–∂–¥–æ–π –≤–Ω–µ—à–Ω–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ—Ç–æ—Ä—É—é –æ–Ω –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å.

### 1. –û—Ç–∫—Ä—ã—Ç–∏–µ –§–∞–π–ª–∞

> _–î–ª—è –∫–∞–∂–¥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `ld.so` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª (—á–µ—Ä–µ–∑ `open()`)_

- –î–ª—è –∫–∞–∂–¥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`.so`) –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç **`open()`** ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª–∞
    
- –ü—Ä–∏–º–µ—Ä:
    
`open("/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY)`

- –≠—Ç–æ **—Ñ–∞–π–ª ELF**, –∫–∞–∫ –∏ –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞, –Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.–∞—Ç–Ω—ã–π `mmap()` –¥–ª—è –°–µ–∫—Ü–∏–π

> _–ó–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `mmap` –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ ELF-—Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç—å:_

–ó–∞–≥—Ä—É–∑—á–∏–∫ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–µ—Å—å —Ñ–∞–π–ª –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–æ–º. –û–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞–∂–¥—É—é –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é **–æ—Ç–¥–µ–ª—å–Ω–æ**, –Ω–∞–∑–Ω–∞—á–∞—è –µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –∏ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å **–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –∏ **—ç–∫–æ–Ω–æ–º–∏—é –ø–∞–º—è—Ç–∏**.

|**–°–µ–∫—Ü–∏—è**|**–ü—Ä–∞–≤–∞ (PROT_*)**|**–†–µ–∂–∏–º (MAP_*)**|**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ / –ü–æ—á–µ–º—É?**|
|---|---|---|---|
|**`.text` (–ö–æ–¥)**|`PROT_READ|PROT_EXEC` (–ß—Ç–µ–Ω–∏–µ –∏ –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ)|`MAP_SHARED` (–†–∞–∑–¥–µ–ª—è–µ–º—ã–π)|
|**`.rodata` (–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã)**|`PROT_READ` (–¢–æ–ª—å–∫–æ –ß—Ç–µ–Ω–∏–µ)|`MAP_SHARED` (–†–∞–∑–¥–µ–ª—è–µ–º—ã–π)|–î–∞–Ω–Ω—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è. –ú–æ–≥—É—Ç –±—ã—Ç—å –æ–±—â–∏–º–∏ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.|
|**`.data` –∏ `.bss` (–î–∞–Ω–Ω—ã–µ)**|`PROT_READ|PROT_WRITE` (–ß—Ç–µ–Ω–∏–µ –∏ –ó–∞–ø–∏—Å—å)|`MAP_PRIVATE` (–ü—Ä–∏–≤–∞—Ç–Ω—ã–π) —Å **CoW**|

### 3. –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –ó–∞–≥—Ä—É–∑–∫–∞

> _–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ: –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å–∞–º–∏ –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –¥—Ä—É–≥–∏—Ö, —Ç–∞–∫ —á—Ç–æ `ld.so` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å—é —Ü–µ–ø–æ—á–∫—É_

- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ C (`libc.so`) –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –¥—Ä—É–≥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `libm.so` –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π).
    
- **–¶–µ–ø–æ—á–∫–∞:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç **–≤—Å—é —Ü–µ–ø–æ—á–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**. –û–Ω –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫ –º–æ–º–µ–Ω—Ç—É –ø–µ—Ä–µ–¥–∞—á–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ **–≤—Å–µ** –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –≤–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã —É–∂–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ.

![[Pasted image 20251212174153.png]]

### 1. –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞—â–∏—Ç–∞ –ö–æ–¥–∞

> _–¢–µ–ø–µ—Ä—å –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º –Ω—É–∂–Ω–æ –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å –∞–¥—Ä–µ—Å–∞ –≤—ã–∑–æ–≤–æ–≤ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ —Å–µ–∫—Ü–∏—è –ø–∞–º—è—Ç–∏ –¥–ª—è –∫–æ–¥–∞ —É –Ω–∞—Å –æ—Ç–∫—Ä—ã—Ç–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ (–ø–æ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)_

- –ö–∞–∫ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏, —Å–µ–∫—Ü–∏—è `.text` (–ö–æ–¥) –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ `PROT_READ | PROT_EXEC` (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ). –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∞—Ç–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—ã—Ç–∞—é—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–Ω–µ—Å—Ç–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥).
    
- **–ù–æ:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `printf`) –±—ã–ª –∑–∞–ø–∏—Å–∞–Ω –∫—É–¥–∞-—Ç–æ, —á—Ç–æ–±—ã –∫–æ–¥ –∑–Ω–∞–ª, –∫—É–¥–∞ –ø—Ä—ã–≥–∞—Ç—å. –ó–∞–ø–∏—Å–∞—Ç—å –µ–≥–æ –ø—Ä—è–º–æ –≤ `.text` **–Ω–µ–ª—å–∑—è**.
    

### 2. –†–µ—à–µ–Ω–∏–µ: –¢–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä (PLT)

> _–í –∫–æ–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞ –º–µ—Å—Ç–∞—Ö, –≥–¥–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–∑–æ–≤—ã –∏–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –±—É–¥—É—Ç –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –∞–¥—Ä–µ—Å–∞ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (PLT)_

- **PLT (Procedure Linkage Table):** –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è, –º–∞–ª–µ–Ω—å–∫–∞—è, –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏, –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.
    
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–∞—à –∫–æ–¥:** –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤—ã–∑—ã–≤–∞—Ç—å `printf` –Ω–∞–ø—Ä—è–º—É—é, –≤–∞—à —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç **–∑–∞–ø–∏—Å—å –≤ PLT**.
    
    - _–í–∞—à –∫–æ–¥:_ "–ü—Ä—ã–≥–Ω—É—Ç—å –≤ –∑–∞–ø–∏—Å—å PLT –¥–ª—è `printf`".
        
- **–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ PLT:** –ó–∞–ø–∏—Å—å –≤ PLT —Å–∞–º–∞ –ø–æ —Å–µ–±–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–≤–∞ –¥–µ–π—Å—Ç–≤–∏—è:
    
    1. –û–Ω —Å–º–æ—Ç—Ä–∏—Ç –≤ –¥—Ä—É–≥—É—é —Ç–∞–±–ª–∏—Ü—É ‚Äî **GOT**.
        
    2. –û–Ω –¥–µ–ª–∞–µ—Ç –ø—Ä—ã–∂–æ–∫ –Ω–∞ –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑–∞–Ω –≤ GOT.
        

### 3. –ö—É–¥–∞ "–ü–∞—Ç—á–∏—Ç—Å—è" –ê–¥—Ä–µ—Å? (GOT)

> _–≠—Ç—É —Ç–∞–±–ª–∏—Ü–∞ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ–∫—Ü–∏–µ–π –∏ –∫ –Ω–µ–π –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å, —Ç–æ –µ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –º–æ–∂–µ—Ç –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å –∞–¥—Ä–µ—Å–∞ –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ_

–°–ª–∞–π–¥ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–π, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã: **GOT (Global Offset Table)**.

- **GOT (Global Offset Table):** –≠—Ç–æ —Ç–∞–±–ª–∏—Ü–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç **—Ä–µ–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –¥–∞–Ω–Ω—ã—Ö.
    
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `.text`, —Å–µ–∫—Ü–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è GOT, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ **–∑–∞–ø–∏—Å—å** (`PROT_WRITE`).
    
- **–ü—Ä–æ—Ü–µ—Å—Å:**
    
    1. **–ù–∞—á–∞–ª–æ:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ, –≤ –∑–∞–ø–∏—Å–∏ GOT –¥–ª—è `printf` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è **–∞–¥—Ä–µ—Å –∫–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ PLT**, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫.
        
    2. **–î–µ–π—Å—Ç–≤–∏–µ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ (`ld.so`) –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å `printf` –≤ `libc.so` –∏ **–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –µ–≥–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —è—á–µ–π–∫—É GOT**.
        
    3. **–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ:** –ö–æ–≥–¥–∞ –≤–∞—à –∫–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `printf`, –æ–Ω –∏–¥–µ—Ç –≤ PLT, PLT —Å–º–æ—Ç—Ä–∏—Ç –≤ GOT, –Ω–∞—Ö–æ–¥–∏—Ç —Ç–∞–º **—Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å** –∏ –ø—Ä—ã–≥–∞–µ—Ç –ø—Ä—è–º–æ –≤ `libc.so`.
---
### 1. üõ°Ô∏è PLT: –ó–∞—â–∏—â—ë–Ω–Ω—ã–π –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π –ö–æ–¥

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏—Ç—å **–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –º–æ—Å—Ç–∏–∫** –∫ –≤–Ω–µ—à–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.
    
- **–ü—Ä–∞–≤–∞:** **–¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ** (`PROT_READ | PROT_EXEC`). –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º.
    
- **–§—É–Ω–∫—Ü–∏—è:** –ö–æ–¥ –≤ PLT **–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å–∞** —Ñ—É–Ω–∫—Ü–∏–∏ `printf`. –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–∞–Ω–¥—É: "–ü–æ—Å–º–æ—Ç—Ä–∏ –≤ —è—á–µ–π–∫—É GOT ‚ÑñX –∏ –ø—Ä—ã–≥–Ω–∏ —Ç—É–¥–∞".

### üìù 2. GOT: –ò–∑–º–µ–Ω—è–µ–º—ã–µ –î–∞–Ω–Ω—ã–µ

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç—å **—Ä–µ–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** —Ñ—É–Ω–∫—Ü–∏–π.
    
- **–ü—Ä–∞–≤–∞:** **–ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å** (`PROT_READ | PROT_WRITE`). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –ó–∞–≥—Ä—É–∑—á–∏–∫—É **–ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å** —ç—Ç–∏ –∞–¥—Ä–µ—Å–∞.
    
- **–§—É–Ω–∫—Ü–∏—è:** –ü–æ—Å–∫–æ–ª—å–∫—É GOT —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–∞ (–¥–∞–Ω–Ω—ã–µ), –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥, –æ–Ω –º–æ–∂–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å.
---

## **–û–ë–©–ò–ô –ü–õ–ê–ù: –∫–∞–∫ —è–¥—Ä–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É (ELF + –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)**

## **I. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã**

## 1. –ö–æ–º–ø–∏–ª—è—Ü–∏—è C ‚Üí –æ–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª `.o`

- —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥
    
- —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–º–≤–æ–ª—ã:  
    ‚úî —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ (–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ)  
    ‚úî –≤–Ω–µ—à–Ω–∏–µ (–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –∏—Å–∫–∞—Ç—å –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö)
## 2. –õ–∏–Ω–∫–æ–≤–∫–∞:

### üîπ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è:
- –≤—Å–µ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–π –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ
- –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ EXE
- –æ—à–∏–±–∫–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
    
### üîπ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è:
- —á–∞—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤ –æ—Å—Ç–∞—ë—Ç—Å—è **–Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–π**
    
- –≤ ELF –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç:
    
    - –∫–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω—É–∂–Ω—ã
    - —Ç–∞–±–ª–∏—Ü—ã PLT/GOT
    - .dynamic —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –∫–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—ã–∑–æ–≤—ã **—á–µ—Ä–µ–∑ PLT**, –∞ –Ω–µ –ø—Ä—è–º—ã–µ –∞–¥—Ä–µ—Å–∞
    
---
# **II. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã: —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ `exec()`**

–ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–∑—ã–≤–∞–µ—Ç `execve()`:

## 3. –Ø–¥—Ä–æ —á–∏—Ç–∞–µ—Ç ELF-–∑–∞–≥–æ–ª–æ–≤–æ–∫

- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç magic number `0x7F ELF`
- –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- —Å–º–æ—Ç—Ä–∏—Ç —Ç–∏–ø = executable / shared object
- –≤–∏–¥–∏—Ç –∞–¥—Ä–µ—Å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (`e_entry`)
- –≤–∏–¥–∏—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –≤ `.interp` (–æ–±—ã—á–Ω–æ `/lib64/ld-linux.so.2`)
    
## 4. –Ø–¥—Ä–æ –û–ß–ò–©–ê–ï–¢ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

–û—Å—Ç–∞—é—Ç—Å—è:

- PID
- —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (–µ—Å–ª–∏ –Ω–µ –∑–∞–∫—Ä—ã—Ç—ã)
- –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞

# **III. –Ø–¥—Ä–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–µ–∫—Ü–∏–∏ ELF –ø—Ä–æ–≥—Ä–∞–º–º—ã (`mmap`)**

## 5. –Ø–¥—Ä–æ –≤—ã–∑—ã–≤–∞–µ—Ç mmap() –¥–ª—è —Å–µ–∫—Ü–∏–π:

- `.text` ‚Üí RX (read + execute)
- `.rodata` ‚Üí R
- `.data` ‚Üí RW
- `.bss` ‚Üí RW, –Ω—É–ª–∏

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:  
‚úî –∑–∞—â–∏—Ç—É –ø–∞–º—è—Ç–∏  
‚úî ASLR (—Å–ª—É—á–∞–π–Ω—ã–µ –∞–¥—Ä–µ—Å–∞)  
‚úî —ç–∫–æ–Ω–æ–º–∏—é (shared code pages)

---

# **IV. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç–µ–∫–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤**

## 6. –Ø–¥—Ä–æ —Å–æ–∑–¥–∞—ë—Ç —Å—Ç–µ–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞:

- –∞—Ä–≥—É–º–µ–Ω—Ç—ã `argv`
- –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `envp`
- auxiliary vector `auxv` (—Å–ª—É–∂–µ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
## 7. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä—ã:

- rdi = argc
- rsi = argv
- –¥—Ä—É–≥–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä

---
# **V. –ü–µ—Ä–µ–¥–∞—á–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –∑–∞–≥—Ä—É–∑—á–∏–∫—É (ld.so)**

## 8. –Ø–¥—Ä–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç **ld.so**, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ `.interp`

–≠—Ç–æ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫**, –∞ –Ω–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞.

–û–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ü–ï–†–í–´–ú.

---
# **VI. –†–∞–±–æ—Ç–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ ld.so**

## 9. –†–∞–∑–±–æ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

ld.so —á–∏—Ç–∞–µ—Ç —Å–µ–∫—Ü–∏—é `.dynamic`:

- –∫–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω—É–∂–Ω—ã
- –∏—Ö –≤–µ—Ä—Å–∏–∏
- –ø—É—Ç–∏ (RPATH, RUNPATH)
    
## 10. –ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ)

–î–ª—è –∫–∞–∂–¥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

### ld.so –¥–µ–ª–∞–µ—Ç:

- `open()` ‚Üí –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª `.so`
- `mmap()` ‚Üí
    
    - `.text` ‚Üí RX, shared
    - `.rodata` ‚Üí R, shared
    - `.data` ‚Üí RW, private (CoW)
    - `.bss` ‚Üí RW, private
        
–ï—Å–ª–∏ libc —Ç—Ä–µ–±—É–µ—Ç libm, —Ç–æ ld.so –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –µ—ë.  
–ü—Ä–æ—Ü–µ—Å—Å **—Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π**.

---

# **VII. –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ (PLT/GOT –ø–∞—Ç—á–∏–Ω–≥)**

## 11. –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø–∞—Ç—á–∏—Ç—å –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥?

–ü–æ—Ç–æ–º—É —á—Ç–æ `.text` = —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ/–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (RX).

## 12. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è PLT –∏ GOT

- PLT (—Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤) ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–µ –ø—Ä—ã–≥–∞—é—â–∏–µ stub‚Äô—ã
- GOT (—Ç–∞–±–ª–∏—Ü–∞ –∞–¥—Ä–µ—Å–æ–≤) ‚Äî —Ö—Ä–∞–Ω–∏—Ç –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü–∏–π
## 13. ld.so –ø–∞—Ç—á–∏—Ç –¢–û–õ–¨–ö–û GOT

- –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—É–¥–∞ –∞–¥—Ä–µ—Å—ã —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫
- PLT –ø—Ä—ã–≥–∞–µ—Ç –Ω–∞ GOT
- —Ç–µ–ø–µ—Ä—å –≤—ã–∑–æ–≤ `printf()` —Ä–∞–±–æ—Ç–∞–µ—Ç
    
---
# **VIII. –ü–µ—Ä–µ–¥–∞—á–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–µ**

## 14. ld.so –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å—ë –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `_start`

- `_start()` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ runtime-–∫–æ–¥–µ (`crt0.o`)
- –≤—ã–∑—ã–≤–∞–µ—Ç `__libc_start_main()`
- –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç `main(argc, argv, envp)`

---

# **IX. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è**

–¢–µ–ø–µ—Ä—å **–≤–∞—à –∫–æ–¥** –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

---

# **X. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã**

`main()` ‚Üí `exit()` ‚Üí —è–¥—Ä–æ –æ—á–∏—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å.
![[Pasted image 20251212174208.png]]

PLT ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π **–≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π** –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö.

### 1. –ß—Ç–æ —Ç–∞–∫–æ–µ PLT?

> _PLT —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–µ –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ, –≥–¥–µ –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—ã–∑–æ–≤—É –≤–Ω–µ—à–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–æ–º_

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** PLT —Å–æ–∑–¥–∞–µ—Ç—Å—è **–ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–æ–º** –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –û–Ω–∞ —Å–ª—É–∂–∏—Ç **–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º —à–ª—é–∑–æ–º** –º–µ–∂–¥—É –≤–∞—à–∏–º –∫–æ–¥–æ–º –∏ –≤–Ω–µ—à–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `printf`).
    
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:** –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å PLT ‚Äî —ç—Ç–æ –Ω–µ–±–æ–ª—å—à–æ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–∑–æ–≤—ã.
    

### 2. –ü—Ä–∏–Ω—Ü–∏–ø –õ–µ–Ω–∏–≤–æ–≥–æ –°–≤—è–∑—ã–≤–∞–Ω–∏—è (Lazy Binding)

–≠—Ç–æ—Ç —Å–ª–∞–π–¥ –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø **–ª–µ–Ω–∏–≤–æ–≥–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è** ‚Äî –∫–ª—é—á–µ–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏.

|**–®–∞–≥**|**–î–µ–π—Å—Ç–≤–∏–µ**|**–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∞–¥—Ä–µ—Å?**|
|---|---|---|
|**–í—ã–∑–æ–≤:**|–í–∞—à –∫–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `printf`). –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–ø–∏—Å—å PLT –¥–ª—è `printf`.|–í –∫–æ–¥–µ –ø—Ä–æ–ø–∏—Å–∞–Ω –∞–¥—Ä–µ—Å –∑–∞–ø–∏—Å–∏ PLT.|
|**1. –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ (–õ–µ–Ω–∏–≤–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ):**|> _–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –∑–∞–ø–∏—Å—å –≤ PLT —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–æ–¥ –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –∑–∞–≥—Ä—É–∑—á–∏–∫–µ, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑—Ä–µ—à–∞–µ—Ç (resolves) –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏_|–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ **–∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –∏–∑–≤–µ—Å—Ç–µ–Ω** –∏ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω –≤ GOT. –ö–æ–¥ –≤ PLT –∑–∞–ø—É—Å–∫–∞–µ—Ç **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫** (`ld.so`).|
|**2. –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:**|–ó–∞–≥—Ä—É–∑—á–∏–∫ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å `printf` –≤ –ø–∞–º—è—Ç–∏ (`libc.so`) –∏ **–ø–∞—Ç—á–∏—Ç (–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç)** —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —è—á–µ–π–∫—É —Ç–∞–±–ª–∏—Ü—ã **GOT**.|–ê–¥—Ä–µ—Å —Ç–µ–ø–µ—Ä—å –Ω–∞–¥—ë–∂–Ω–æ –∑–∞–ø–∏—Å–∞–Ω –≤ GOT.|
|**3. –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã:**|> _–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ GOT, –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã —á–µ—Ä–µ–∑ PLT –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –Ω–∞–ø—Ä—è–º—É—é, –º–∏–Ω—É—è –∑–∞–≥—Ä—É–∑—á–∏–∫_|PLT –ø—Ä–æ—Å—Ç–æ —á–∏—Ç–∞–µ—Ç **—É–∂–µ –≥–æ—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å** –∏–∑ GOT –∏ –ø—Ä—ã–≥–∞–µ—Ç (–ø–µ—Ä–µ–¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ) –ø—Ä—è–º–æ –≤ —Ñ—É–Ω–∫—Ü–∏—é `printf`.|

### üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –õ–µ–Ω–∏–≤–æ–≥–æ –°–≤—è–∑—ã–≤–∞–Ω–∏—è

- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞:** –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫ –Ω–µ —Ç—Ä–∞—Ç–∏—Ç –≤—Ä–µ–º—è –Ω–∞ –ø–æ–∏—Å–∫ –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ **–≤—Å–µ—Ö** —Ñ—É–Ω–∫—Ü–∏–π. –û–Ω —Å–≤—è–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é **—Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–ø–µ—Ä–≤—ã–µ**.
    
- **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏:** –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ 10% —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –æ–≥—Ä–æ–º–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —ç—Ç–∏ 10%.
    

–° –ø–æ–º–æ—â—å—é PLT/GOT –º—ã —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–∑–∞—â–∏—Ç–∞ `.text`) –∏ –¥–æ–±–∏–ª–∏—Å—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ª–µ–Ω–∏–≤–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ).

![[Pasted image 20251212174221.png]]

GOT ‚Äî —ç—Ç–æ **—Ç–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö**, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—É –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ó–∞–≥—Ä—É–∑—á–∏–∫–∞, –Ω–µ –Ω–∞—Ä—É—à–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

|**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞**|**–û–ø–∏—Å–∞–Ω–∏–µ**|**–°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º–∏**|
|---|---|---|
|**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç?**|**–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∞–¥—Ä–µ—Å–∞ –≤ –ø–∞–º—è—Ç–∏) **–≤—Å–µ—Ö** –≤–Ω–µ—à–Ω–∏—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–π), –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞.|–°–∏–º–≤–æ–ª—ã ‚Äî —ç—Ç–æ –∏–º–µ–Ω–∞, –∞ GOT —Ö—Ä–∞–Ω–∏—Ç –∏—Ö **–∞–¥—Ä–µ—Å–∞**.|
|**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞?**|–í –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ **–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä/–ª–∏–Ω–∫–µ—Ä –Ω–µ –∑–Ω–∞–µ—Ç** —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç ASLR –∏ –ø–æ—Ä—è–¥–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫. GOT –ø–æ–∑–≤–æ–ª—è–µ—Ç **–æ—Ç–ª–æ–∂–∏—Ç—å** —ç—Ç–æ –∑–Ω–∞–Ω–∏–µ –¥–æ Runtime.|–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏**.|
|**–ö—Ç–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç?**|**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ó–∞–≥—Ä—É–∑—á–∏–∫** (`ld.so`) –Ω–∞ —ç—Ç–∞–ø–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –û–Ω –∏—â–µ—Ç —Å–∏–º–≤–æ–ª—ã –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Ö –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ GOT.|–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É **–†–µ–ª–æ–∫–∞—Ü–∏–∏**.|
|**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**|**–ß—Ç–µ–Ω–∏–µ –∏ –ó–∞–ø–∏—Å—å** (`PROT_READ|PROT_WRITE`).|

### üí° GOT –∏ PLT –≤–º–µ—Å—Ç–µ

- **GOT** ‚Äî —ç—Ç–æ **–∑–∞–ø–∏—Å—ã–≤–∞–µ–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö** (–∞–¥—Ä–µ—Å–æ–≤).
    
- **PLT** ‚Äî —ç—Ç–æ **–∑–∞—â–∏—â–µ–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥**, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥—Ä–µ—Å–∞ –∏–∑ GOT.
    

–í–º–µ—Å—Ç–µ –æ–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç, —á—Ç–æ –≤–Ω–µ—à–Ω–∏–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–º, –¥–∞–∂–µ –µ—Å–ª–∏ –µ–≥–æ —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (–∏ –¥–∞–∂–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ).

![[Pasted image 20251212174235.png]]

–≠—Ç–æ—Ç —Å–ª–∞–π–¥ –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏** (PLT, GOT, CoW), –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ–±—Å—É–∂–¥–∞–ª–∏.

### 1. –§–ª–∞–≥ `-shared`

> `gcc -o lib<–Ω–∞–∑–≤–∞–Ω–∏–µ>.so -shared -fPIC <–∫–æ–¥.c> ...`
> 
> `-shared` –∫–æ–º–ø–æ–Ω—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—ã—á–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è (`gcc <—Ñ–∞–π–ª.c>`) —Å–æ–∑–¥–∞–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π ELF-—Ñ–∞–π–ª (—Ç–∏–ø `EXEC`). –§–ª–∞–≥ `-shared` —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–º–ø–æ–Ω–æ–≤—â–∏–∫—É, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É** (—Ç–∏–ø `DYN`, —Ç.–µ. Shared Object, `.so`).
    
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥, –Ω–æ –Ω–µ –∏–º–µ–µ—Ç "–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞" (`_start`), —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞–ø—Ä—è–º—É—é. –û–Ω –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è **–∑–∞–≥—Ä—É–∑–∫–∏** –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π.
    

### 2. –§–ª–∞–≥ `-fPIC` (Position-Independent Code)

> `-fPIC` —Å–æ–∑–¥–∞—ë—Ç PLT –∏ GOT —Å–µ–≥–º–µ–Ω—Ç—ã –∏ –ø–∞—Ç—á–∏—Ç –∞–¥—Ä–µ—Å–∞ –≤ —ç—Ç–∏—Ö —Å–µ–∫—Ü–∏—è—Ö, —á—Ç–æ–±—ã –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π —Å—Å—ã–ª–∞–ª–∏—Å—å –Ω–∞ –ø—Ä–æ–ø–∞—Ç—á–µ–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ

- **PIC (Position-Independent Code):** **–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ-–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –∫–æ–¥**. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.
    
- **–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ PIC:** –ï—Å–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏, –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø–∞–º—è—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ –æ–¥–Ω–æ–º—É, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∞–¥—Ä–µ—Å—É. –ï—Å–ª–∏ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å —É–∂–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —É–¥–∞—Å—Ç—Å—è.
    
- **–†–µ—à–µ–Ω–∏–µ —Å PIC:** –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π **–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–≤–æ–µ–≥–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞** –≤ –ø–∞–º—è—Ç–∏. –í–º–µ—Å—Ç–æ –∂–µ—Å—Ç–∫–∏—Ö –∞–¥—Ä–µ—Å–æ–≤, –∫–æ–¥ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –¥–∞–Ω–Ω—ã–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥–ª–æ–±–∞–ª—å–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è–º) **—á–µ—Ä–µ–∑ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å–º–µ—â–µ–Ω–∏—è**, –∏–ª–∏, —á—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ, **—á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—ã PLT –∏ GOT**.
    

### 3. –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è `-fPIC` (–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã)

–ù–∞–ª–∏—á–∏–µ `-fPIC` –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω–æ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ —ç–∫–æ–Ω–æ–º–∏–µ–π –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏:

1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é (–ó–∞–ø–∏—Å—å –≤ `.text`):**
    
    > _–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–¥–µ–ª–∞—Ç—å `-shared` –±–µ–∑ `-fPIC`, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø–æ–ø—Ä–æ–±—É–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Å–µ–∫—Ü–∏—é –∫–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å –∞–¥—Ä–µ—Å–∞ —Ç–∞–º... –≠—Ç–æ –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å!_
    
    –ö–æ–≥–¥–∞ –∫–æ–¥ **–Ω–µ** –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ-–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π, –∑–∞–≥—Ä—É–∑—á–∏–∫—É –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑–º–µ–Ω–∏—Ç—å –µ–≥–æ –≤ —Å–µ–∫—Ü–∏–∏ `.text`. –î–ª—è —ç—Ç–æ–≥–æ –µ–º—É –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–∞—Ç—å —Å–µ–∫—Ü–∏–∏ `.text` –ø—Ä–∞–≤–∞ –Ω–∞ **–∑–∞–ø–∏—Å—å** (`PROT_WRITE`). –≠—Ç–æ **–≥—Ä—É–±–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** (–≤—Å–ø–æ–º–Ω–∏—Ç–µ ASLR –∏ –∑–∞—â–∏—Ç—É –æ—Ç –∞—Ç–∞–∫!) –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—Ä–µ—â–µ–Ω–æ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –û–°.
    
2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —ç–∫–æ–Ω–æ–º–∏–µ–π –ø–∞–º—è—Ç–∏ (CoW):**
    
    > _–ü–æ–º–∏–º–æ —ç—Ç–æ–≥–æ, –≤ –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É –±–µ–∑ `-fPIC`, –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ—é –∫–æ–ø–∏—é –∫–æ–¥–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π!_
    
    –ï—Å–ª–∏ –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ –¥–ª—è –≤—Å–µ—Ö, –∏ –∑–∞–≥—Ä—É–∑—á–∏–∫—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –µ–≥–æ "–ø–∞—Ç—á–∏—Ç—å" (–∏–∑–º–µ–Ω—è—Ç—å), —Ç–æ —è–¥—Ä–æ –Ω–µ —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º **Copy-on-Write (CoW)** –∏ **—Ä–∞–∑–¥–µ–ª—è–µ–º—É—é –ø–∞–º—è—Ç—å** (`MAP_SHARED`). –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ, –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∏—Ç **—Å–≤–æ—é –ø—Ä–∏–≤–∞—Ç–Ω—É—é –∫–æ–ø–∏—é** –≤—Å–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —á—Ç–æ —Ä–µ–∑–∫–æ —É–≤–µ–ª–∏—á–∏—Ç —Ä–∞—Å—Ö–æ–¥ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
    

**–ò—Ç–æ–≥:** –§–ª–∞–≥ `-fPIC` ‚Äî —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—è —Ç–æ–≥–æ, —á—Ç–æ –≤–∞—à–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ (—ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏) –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ (–∑–∞—â–∏—Ç–∞ –∫–æ–¥–∞ –æ—Ç –∑–∞–ø–∏—Å–∏) –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

# –ü—Ä–∏–º–µ—Ä: —Å–æ–∑–¥–∞—ë–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É `libmathutil.so`

–ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å —Ñ–∞–π–ª `mathutil.c`:

```
// mathutil.c
int add(int a, int b) {
    return a + b;
}

int mul(int a, int b) {
    return a * b;
}
```

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –∏–∑ –Ω–µ–≥–æ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É**:

`gcc -o libmathutil.so -shared -fPIC mathutil.c`

---

# üîç –†–∞–∑–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã

|–§–ª–∞–≥|–ß—Ç–æ –¥–µ–ª–∞–µ—Ç|
|---|---|
|`-o libmathutil.so`|–ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ ‚Äî —ç—Ç–æ –±—É–¥–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `.so`|
|`-shared`|–°–æ–∑–¥–∞—Ç—å **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É**, –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª|
|`-fPIC`|–°–¥–µ–ª–∞—Ç—å –∫–æ–¥ **–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ-–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º**, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ PLT/GOT|
|`mathutil.c`|–ò—Å—Ö–æ–¥–Ω–∏–∫ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏|

![[Pasted image 20251212174311.png]]
## –ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤ Runtime (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

–î–æ —ç—Ç–æ–≥–æ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏, —á—Ç–æ **–Ø–¥—Ä–æ** –∏ **`ld.so`** –∑–∞–≥—Ä—É–∂–∞—é—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –≠—Ç–æ—Ç —Å–ª–∞–π–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ **—Å–∞–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞** –º–æ–∂–µ—Ç **–ø–æ —Å–≤–æ–µ–º—É –∂–µ–ª–∞–Ω–∏—é** –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

–î–ª—è —ç—Ç–æ–≥–æ –≤ Linux –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π **`dlfcn.h`** (Dynamic Linking Functions):

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª)

> `#include <dlfcn.h>`
> 
> `typedef float custom_fabsf_func(float x);` `custom_fabsf_func custom_fabsf = NULL;`

- **`dlfcn.h`:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏.
    
- **`typedef`:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ö–æ—Ç–∏–º –∑–∞–≥—Ä—É–∑–∏—Ç—å (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –∞–Ω–∞–ª–æ–≥ `fabsf` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è).
    
- **–£–∫–∞–∑–∞—Ç–µ–ª—å:** –û–±—ä—è–≤–ª—è–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å (`custom_fabsf`), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∞–¥—Ä–µ—Å —ç—Ç–æ–π –≤–Ω–µ—à–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.
    

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`dlopen()`)

> `void *library = dlopen(‚Äú./libcustom.so‚Äù, RTLD_LOCAL | RTLD_LAZY);`

- **`dlopen()`:** –§—É–Ω–∫—Ü–∏—è –¥–ª—è **–∑–∞–≥—Ä—É–∑–∫–∏** —É–∫–∞–∑–∞–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`./libcustom.so`) –≤ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
    
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä** (—É–∫–∞–∑–∞—Ç–µ–ª—å `void *library`), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π.
    
- **–§–ª–∞–≥–∏:**
    
    - **`RTLD_LOCAL`:** –°–∏–º–≤–æ–ª—ã —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –¥—Ä—É–≥–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –ø–æ–∑–∂–µ.
        
    - **`RTLD_LAZY`:** –ì–ª–∞–≤–Ω–æ–µ! –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ª–µ–Ω–∏–≤–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ (Lazy Binding)**: —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç —Å–≤—è–∑–∞–Ω—ã —Å –∞–¥—Ä–µ—Å–∞–º–∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –æ–Ω–∏ –±—É–¥—É—Ç –≤—ã–∑–≤–∞–Ω—ã –≤–ø–µ—Ä–≤—ã–µ (–∫–∞–∫ –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ PLT/GOT, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ä–∞–∑–±–∏—Ä–∞–ª–∏).
        

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ê–¥—Ä–µ—Å–∞ –§—É–Ω–∫—Ü–∏–∏ (`dlsym()`)

> `custom_fabsf = dlsym(library, "custom_fabsf");`

- **`dlsym()` (dynamic symbol):** –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–ø–æ–∏—Å–∫** –≤–Ω—É—Ç—Ä–∏ —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
    
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
    
    1. –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`library`), –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç `dlopen()`.
        
    2. –ò–º—è —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—â–µ–º (—Å—Ç—Ä–æ–∫–∞ `"custom_fabsf"`).
        
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–∞–±—Å–æ–ª—é—Ç–Ω—ã–π –∞–¥—Ä–µ—Å** –∏—Å–∫–æ–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ—Ç –∞–¥—Ä–µ—Å –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞—à–µ–º—É —É–∫–∞–∑–∞—Ç–µ–ª—é (`custom_fabsf`).
    

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –§—É–Ω–∫—Ü–∏–∏

> `float x = custom_fabsf(-3.14159f);`

- –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É–∫–∞–∑–∞—Ç–µ–ª—å `custom_fabsf` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è **–≤—ã–∑–æ–≤–∞** –≤–Ω–µ—à–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∫–∞–∫ –µ—Å–ª–∏ –±—ã –æ–Ω–∞ –±—ã–ª–∞ —á–∞—Å—Ç—å—é –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ.
    

### 5. –û—á–∏—Å—Ç–∫–∞ (–ù–µ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Å–ª–∞–π–¥–µ)

–î–ª—è –ø–æ–ª–Ω–æ—Ç—ã –∫–∞—Ä—Ç–∏–Ω—ã: –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫—É –Ω—É–∂–Ω–æ –≤—ã–≥—Ä—É–∑–∏—Ç—å, –≤—ã–∑–≤–∞–≤ **`dlclose(library)`**. –≠—Ç–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç –∑–∞–Ω—è—Ç—É—é –ø–∞–º—è—Ç—å.

---

### üí° –†–µ–∑—é–º–µ –ø–æ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ó–∞–≥—Ä—É–∑–∫–µ (dlopen)

–≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:

1. **–ü–ª–∞–≥–∏–Ω–æ–≤ (Plugins):** –ü—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
    
2. **–≠–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤:** –ó–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –æ–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω—ã.
    
3. **–ì–∏–±–∫–æ—Å—Ç–∏:** –í—ã–±–æ—Ä, –∫–∞–∫—É—é –≤–µ—Ä—Å–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –ø—Ä—è–º–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---
–í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º **—Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫** —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π:

## 1. üèóÔ∏è –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (Reusability)

–≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞.

- **–ò–∑–æ–ª—è—Ü–∏—è –∫–æ–¥–∞:** –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø–∞–∫–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞–ª–æ–≤ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö) –≤ –æ–¥–∏–Ω –º–æ–¥—É–ª—å.
    
- **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å 10 —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–µ–Ω —Ä–∞—Å—á—ë—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª–∞, –≤—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ –æ–¥–Ω—É –∏ —Ç—É –∂–µ `libmath.so` –∫–æ –≤—Å–µ–º 10 –ø—Ä–æ–µ–∫—Ç–∞–º. –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫.
    
- **–ü—Ä–∏–º–µ—Ä –≤ –≤–∞—à–µ–π —Ä–∞–±–æ—Ç–µ:** –í—ã —Å–æ–∑–¥–∞–ª–∏ `libA.so`. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –Ω–µ —Ç–æ–ª—å–∫–æ –≤ `program_1` –∏ `program_2`, –Ω–æ –∏ –≤ –ª—é–±–æ–º –Ω–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ.
    

## 2. üõ°Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ò–∑–æ–ª—è—Ü–∏—è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Management)

- **–£–ø—Ä–æ—â–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** –í–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (`main`) —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–∏—â–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ–π –Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Ç–∞ –∏–ª–∏ –∏–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –û–Ω–∞ –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ—Å–∏—Ç" –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É.
    
- **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è:** –í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–π "–∫–æ–Ω—Ç—Ä–∞–∫—Ç" (–∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª) –≤–Ω–µ—à–Ω–µ–º—É –º–∏—Ä—É.
    

## 3. üíæ –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞ –∏ –ì–∏–±–∫–æ—Å—Ç—å (Dynamic Linking Benefits)

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ** –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`.so`), –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≤—Å–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏:

- **–≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ (CoW):** –ï—Å–ª–∏ 100 –ø—Ä–æ–≥—Ä–∞–º–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–∞—à—É `libA.so`, –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞–∑–¥–µ–ª—è—Ç—å –æ–¥–Ω—É –∫–æ–ø–∏—é –∫–æ–¥–∞ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏.
    
- **–ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞:** –í–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (`program_1`) –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –Ω–∞ –¥–∏—Å–∫–µ –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏.
    
- **–ì–æ—Ä—è—á–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (Hot Patching):** –í—ã –º–æ–∂–µ—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É (–∑–∞–º–µ–Ω–∏—Ç—å `libA.so` –Ω–∞ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é) **–±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É** (`program_1`). –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ `program_1` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
    

## 4. üß© –ü–ª–∞–≥–∏–Ω—ã –∏ –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å (Plugins and Extensibility)

- –ú–µ—Ö–∞–Ω–∏–∑–º **—Ä—É—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (`dlopen/dlsym`)** (–∫–∞–∫ –≤ –≤–∞—à–µ–π –ü—Ä–æ–≥—Ä–∞–º–º–µ ‚Ññ2) –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø–ª–∞–≥–∏–Ω–æ–≤.
    
- **–ü—Ä–∏–º–µ—Ä:** –í–µ–±-–±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –Ω–µ –∑–Ω–∞—é—Ç –∑–∞—Ä–∞–Ω–µ–µ, –∫–∞–∫–∏–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –û–Ω–∏ –ø—Ä–æ—Å—Ç–æ –∏—â—É—Ç —Ñ–∞–π–ª—ã `.so` –≤ –ø–∞–ø–∫–µ "Plugins" –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç –∏—Ö —Å –ø–æ–º–æ—â—å—é `dlopen()`. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ–π –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–¥–∞.